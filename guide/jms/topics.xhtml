<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:page="http://tjansen.de/refPage" xmlns:i="http://tjansen.de/internal"><head><title>Using Topics - JMS Guide</title><meta http-equiv="X-UA-Compatible" content="chrome=1"/><meta http-equiv="content-language" content="en"/><link rel="shortcut icon" href="../../images/favicon.png" type="image/png"/><link rel="stylesheet" type="text/css" href="../../style/style.css"/><script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-6791190-2']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
})();
</script><script type="text/javascript" src="../../js/all.js"/></head><body id="body"><div id="visibleContent"><div id="top"><a href="/"><img src="../../images/titlebar.png" alt="Jarfiller.com"/></a></div><div id="main"><div id="bodycolumn"><div class="yahbar"><div class="yahprev"><a href="sendingreceivingejb3.xhtml">Prev</a></div><h3 class="yahhere"><a href="#" onclick="return navToggle();">JMS Guide / Using Topics</a></h3><div class="yahnext"><a href="messagetypes.xhtml">Next</a></div></div><h1 id="sec_topics" class="multipageTitle"><a name="topics">Using Topics</a></h1><div class="subSecRow2" id="sec_sendingtopics"><div class="subSecHead" id="sechd_sendingtopics"><a name="sendingtopics">Sending Topic Messages</a></div><div class="subSecContent" id="seccnt_sendingtopics"><p class="subSecExplanation"><em>Sending messages to a <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Topic.html" class="javadoc">Topic</a> is identical to sending them to a <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Queue.html" class="javadoc">Queue</a></em>. Just obtain a <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Topic.html" class="javadoc">Topic</a> instead of the <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Queue.html" class="javadoc">Queue</a>. If you are writing a stand-alone client, use <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createTopic(java.lang.String)" class="javadoc">createTopic</a> instead of <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createQueue(java.lang.String)" class="javadoc">createQueue</a> to get the <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Topic.html" class="javadoc">Topic</a> instance.</p></div></div><div class="subSecRow1" id="sec_receivingtopics"><div class="subSecHead" id="sechd_receivingtopics"><a name="receivingtopics">Receiving Topic Messages</a><br/>(<a href="#" id="tl-d18684e1828" class="dottedTooltip" onclick="return tlClick('tl-d18684e1828','pp-d18684e1833');" onmouseover="return tlOver('tl-d18684e1828','pp-d18684e1833');" onmouseout="return tlOut('tl-d18684e1828','pp-d18684e1833');">more</a>)
		</div><div class="subSecContent" id="seccnt_receivingtopics"><pre class="subSecCode"><code><a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Connection.html" class="javadoc">Connection</a> con = <span class="abstract">...</span>;
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html" class="javadoc">Session</a> session = <span class="abstract">...</span>;
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Topic.html" class="javadoc">Topic</a> topic = <span class="abstract">...</span>;

<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> consumer = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createConsumer(javax.jms.Destination)" class="javadoc"><em>createConsumer</em></a>(topic);  <span class="cmt">// <em>subscribe</em> (<a href="#" id="tl-d18684e1888" class="dottedTooltip" onclick="return tlClick('tl-d18684e1888','pp-d18684e1888');" onmouseover="return tlOver('tl-d18684e1888','pp-d18684e1888');" onmouseout="return tlOut('tl-d18684e1888','pp-d18684e1888');">more</a>)</span>
con.<em><a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Connection.html#start()" class="javadoc">start</a></em>();                                               <span class="cmt">// start the connection</span>
</code></pre><p class="subSecExplanation"> Now you have a <a href="#" id="tl-d18684e1907" class="dottedTooltip" onclick="return tlClick('tl-d18684e1907','pp-d18684e1910');" onmouseover="return tlOver('tl-d18684e1907','pp-d18684e1910');" onmouseout="return tlOut('tl-d18684e1907','pp-d18684e1910');">non-durable subscription</a>. You can either poll for or listen to messages, as you would on a queue.<br/> In order to end the non-durable subscription, close either the <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> or the whole <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Connection.html" class="javadoc">Connection</a>: </p><pre class="subSecCode"><code>consumer.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html#close()" class="javadoc">close</a>();  <span class="cmt">// <em>unsubscribe</em> (nondurable only)</span>
</code></pre></div></div><div class="subSecRow2" id="sec_durablesubscription"><div class="subSecHead" id="sechd_durablesubscription"><a name="durablesubscription">Durable Subscription</a><br/>(<a href="#" id="tl-d18684e1941" class="dottedTooltip" onclick="return tlClick('tl-d18684e1941','pp-d18684e1946');" onmouseover="return tlOver('tl-d18684e1941','pp-d18684e1946');" onmouseout="return tlOut('tl-d18684e1941','pp-d18684e1946');">more</a>)
		</div><div class="subSecContent" id="seccnt_durablesubscription"><pre class="subSecCode"><code><a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Connection.html" class="javadoc">Connection</a> con = <span class="abstract">...</span>;
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html" class="javadoc">Session</a> session = <span class="abstract">...</span>;
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Topic.html" class="javadoc">Topic</a> topic = <span class="abstract">...</span>;
con.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Connection.html#setClientID(java.lang.String)" class="javadoc"><em>setClientID</em></a>("JmsTest");                                               <span class="cmt">// required! (<a href="#" id="tl-d18684e2001" class="dottedTooltip" onclick="return tlClick('tl-d18684e2001','pp-d18684e2001');" onmouseover="return tlOver('tl-d18684e2001','pp-d18684e2001');" onmouseout="return tlOut('tl-d18684e2001','pp-d18684e2001');">more</a>)</span>

<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> consumer = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createDurableSubscriber(javax.jms.Topic, java.lang.String)" class="javadoc"><em>createDurableSubscriber</em></a>(queue, "<em>s1</em>");  <span class="cmt">// subscribe (<a href="#" id="tl-d18684e2031" class="dottedTooltip" onclick="return tlClick('tl-d18684e2031','pp-d18684e2031');" onmouseover="return tlOver('tl-d18684e2031','pp-d18684e2031');" onmouseout="return tlOut('tl-d18684e2031','pp-d18684e2031');">more</a>)</span>
con.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Connection.html#start()" class="javadoc">start</a>();
</code></pre><p class="subSecExplanation"> Now you have a <a href="#" id="tl-d18684e2043" class="dottedTooltip" onclick="return tlClick('tl-d18684e2043','pp-d18684e2046');" onmouseover="return tlOver('tl-d18684e2043','pp-d18684e2046');" onmouseout="return tlOut('tl-d18684e2043','pp-d18684e2046');">durable subscription</a>. If you used the <em>same client ID and subscription name</em> again, you connect to an existing subscription. Otherwise you create a new one.<br/> The subscription exists until you explicitly unsubscribe by calling the <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#unsubscribe(java.lang.String)" class="javadoc">unsubscribe</a> method. Closing the <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> does not end the durable subscription. </p></div></div><div class="subSecRow1" id="sec_endingsubscription"><div class="subSecHead" id="sechd_endingsubscription"><a name="endingsubscription">Cancelling a subscription</a></div><div class="subSecContent" id="seccnt_endingsubscription"><p class="subSecExplanation">A durable subscription must be explicitly unsubscribed (non-durable subscriptions end automatically after closing).</p><pre class="subSecCode"><code><a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html" class="javadoc">Session</a> session = <span class="abstract">...</span>;
session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#unsubscribe(java.lang.String)" class="javadoc"><em>unsubscribe</em></a>("s1");  <span class="cmt">// no open <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> allowed here (<a href="#" id="tl-d18684e2094" class="dottedTooltip" onclick="return tlClick('tl-d18684e2094','pp-d18684e2094');" onmouseover="return tlOver('tl-d18684e2094','pp-d18684e2094');" onmouseout="return tlOut('tl-d18684e2094','pp-d18684e2094');">more</a>)</span>
</code></pre></div></div><div class="yahbar"><div class="yahprev"><a href="sendingreceivingejb3.xhtml">Prev<br/><span>Sending and Receiving Messages in EJB 3 Applications</span></a></div><div class="yahhere"><a href="#" onclick="return navToggle();">JMS Guide / Using Topics</a><br/><a href="/guide/jms/"><span>Single Page Mode</span></a>, <a href="#" onclick="return navToggle();"><span>Show Table of Content</span></a></div><div class="yahnext"><a href="messagetypes.xhtml">Next<br/><span>Message Types</span></a></div></div></div><div id="sidecolumn">
    	<div><h3>Useful Links</h3><div class="sidecolumnSubTitleLine"/>
  			<a href="http://java.sun.com/products/jms/">JMS Homepage</a><br/>
  			<a href="http://en.wikipedia.org/wiki/Java_Message_Service">JMS on Wikipedia</a><br/>
  			<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/package-summary.html">javax.jms API Docs</a><br/>
  			<a href="http://java.sun.com/products/jms/docs.html">JMS Specification</a><br/>
  		</div>
  </div></div></div><div id="footer"><div id="footer-content"><div id="footer-left"><div class="footerLine"><a href="/">Home</a> - <a href="/about">About Jarfiller</a> - <a href="/imprint.xhtml">Imprint</a></div><div class="footerLine">Please send feedback and corrections to <a href="mailto:tim@tjansen.de">tim@<span style="display: none">got you</span>tjansen.de</a>.</div><div class="footerLine"><a href="http://www.twitter.com/timjansen">Follow</a> me on Twitter.</div><div class="copyrightLine">© 2010 Tim Jansen; content licensed under <a href="http://creativecommons.org/licenses/by/3.0/us/">cc-by</a>; example source code is public domain
				</div></div><div id="footer-right"><a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="../../images/ext/cc-by-88x31.png"/></a></div></div></div><div id="navbar" onclick="return navToggle();" onmouseover="document.getElementById('navbar').className='mouseover';" onmouseout="document.getElementById('navbar').className='';"/><div id="navcontainer"><div id="navlinks"><div id="navclosebar"><a href="#" onclick="return navClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="navpositionbar" class="navpositionbar"/><h2 id="navtitle">JMS Guide</h2><a id="nav_jmsoverview" class="navseclink" href="jmsoverview.xhtml#jmsoverview">Overview</a><a id="nav_intro" class="navsublink" href="jmsoverview.xhtml#intro">Intro</a><a id="nav_usecases" class="navsublink" href="jmsoverview.xhtml#usecases">When should JMS be used?</a><a id="nav_requirements" class="navsublink" href="jmsoverview.xhtml#requirements">What do you need for JMS?</a><a id="nav_destinations" class="navsublink" href="jmsoverview.xhtml#destinations">Destinations</a><a id="nav_standaloneclient" class="navseclink" href="standaloneclient.xhtml#standaloneclient">Sending and Receiving Messages (Standalone Client)</a><a id="nav_sending" class="navsublink" href="standaloneclient.xhtml#sending">Sending a message</a><a id="nav_polling" class="navsublink" href="standaloneclient.xhtml#polling">Polling for messages</a><a id="nav_messagelistener" class="navsublink" href="standaloneclient.xhtml#messagelistener">Using a MessageListener</a><a id="nav_jndi" class="navsublink" href="standaloneclient.xhtml#jndi">Getting the ConnectionFactory via JNDI</a><a id="nav_activemqsetup" class="navsublink" href="standaloneclient.xhtml#activemqsetup">How to set up ActiveMQ</a><a id="nav_webspheremqsetup" class="navsublink" href="standaloneclient.xhtml#webspheremqsetup">How to set up Websphere MQ</a><a id="nav_sendingreceivingejb3" class="navseclink" href="sendingreceivingejb3.xhtml#sendingreceivingejb3">Sending and Receiving Messages in EJB 3 Applications</a><a id="nav_sendingejb3" class="navsublink" href="sendingreceivingejb3.xhtml#sendingejb3">Sending Messages</a><a id="nav_receivingejb3" class="navsublink" href="sendingreceivingejb3.xhtml#receivingejb3">Receiving messages</a><a id="nav_jbosssetup" class="navsublink" href="sendingreceivingejb3.xhtml#jbosssetup">How to set up JBoss 5.x</a><a id="nav_topics" class="navseclink" href="#topics" onclick="if (event.button == 0) return goTo('#topics', true); else return true;">Using Topics</a><a id="nav_sendingtopics" class="navsublink" href="#sendingtopics" onclick="if (event.button == 0) return goTo('#sendingtopics', true); else return true;">Sending Topic Messages</a><a id="nav_receivingtopics" class="navsublink" href="#receivingtopics" onclick="if (event.button == 0) return goTo('#receivingtopics', true); else return true;">Receiving Topic Messages</a><a id="nav_durablesubscription" class="navsublink" href="#durablesubscription" onclick="if (event.button == 0) return goTo('#durablesubscription', true); else return true;">Durable Subscription</a><a id="nav_endingsubscription" class="navsublink" href="#endingsubscription" onclick="if (event.button == 0) return goTo('#endingsubscription', true); else return true;">Cancelling a subscription</a><a id="nav_messagetypes" class="navseclink" href="messagetypes.xhtml#messagetypes">Message Types</a><a id="nav_textmessages" class="navsublink" href="messagetypes.xhtml#textmessages">TextMessage</a><a id="nav_mapmessages" class="navsublink" href="messagetypes.xhtml#mapmessages">MapMessage</a><a id="nav_streammessages" class="navsublink" href="messagetypes.xhtml#streammessages">StreamMessage</a><a id="nav_objectmessages" class="navsublink" href="messagetypes.xhtml#objectmessages">ObjectMessage</a><a id="nav_bytesmessages" class="navsublink" href="messagetypes.xhtml#bytesmessages">BytesMessage</a><a id="nav_emptymessages" class="navsublink" href="messagetypes.xhtml#emptymessages">Empty Messages</a><span class="navseclink">How to...</span><a id="nav_messageheaders" class="navsublink" href="messageheaders.xhtml#messageheaders">How to use Message Headers</a><a id="nav_messageproperties" class="navsublink" href="messageproperties.xhtml#messageproperties">How to read and set Message Properties</a><a id="nav_selectors" class="navsublink" href="selectors.xhtml#selectors">How to use Message Selectors to filter messages</a><a id="nav_xml" class="navsublink" href="xml.xhtml#xml">How to send and receive XML messages with DOM or JAXB</a><a id="nav_achknowledgement" class="navsublink" href="achknowledgement.xhtml#achknowledgement">How to control acknowledgement</a><a id="nav_browsing" class="navsublink" href="browsing.xhtml#browsing">How to browse the messages in a queue</a><a id="nav_authentication" class="navsublink" href="authentication.xhtml#authentication">How to authenticate a connection</a><a id="nav_temporaryqueues" class="navsublink" href="temporaryqueues.xhtml#temporaryqueues">How to Create Temporary Queues or Topics</a><a id="nav_requestresponse" class="navsublink" href="requestresponse.xhtml#requestresponse">How to send a response to a message (Request/Reply)</a><a id="nav_deliveryoptions" class="navsublink" href="deliveryoptions.xhtml#deliveryoptions">How to Control Message Delivery (Delivery Mode, Time-to-live and Priority)</a><a id="nav_activationproperties" class="navsublink" href="activationproperties.xhtml#activationproperties">How to Configure a Message-Driven Bean (Activation Properties, Durable Subscriptions)</a><a id="nav_concurrency" class="navsublink" href="concurrency.xhtml#concurrency">How to use JMS in multi-threaded applications</a><a id="nav_classes10" class="navsublink" href="classes10.xhtml#classes10">How to Use QueueConnectionFactory, QueueConnection, QueueSession...</a><a id="nav_andnow" class="navseclink" href="andnow.xhtml#andnow">And now...?</a><a id="nav_nextsteps" class="navsublink" href="andnow.xhtml#nextsteps">Next Steps</a></div></div><div id="popups"><div id="pp-d18684e1833" class="tooltip">In order to receive messages from a <span class="idf">Topic</span>, you need to be to be subscribed to the <span class="idf">Topic</span>. This is simpler than it sounds - for a nondurable subscription you only create a <span class="idf">MessageConsumer</span> as you would for a queue. Note that with a nondurable subscription you only receive those messages sent ("published" in JMS speak) while you are subscribed to the <span class="idf">Topic</span>.</div><div id="pp-d18684e1888" class="tooltip">Listening to a <span class="idf">Topic</span> is called 'subscribing' to it. Since JMS 1.1 topics and queues use the same methods, and thus this terminology does not appear in the API anymore.</div><div id="pp-d18684e1946" class="tooltip">In order to receive a <span class="idf">Topic</span>s messages even if temporarily disconnected, you must create a durable subscription. This is easy to do: instead of <span class="idf">createConsumer</span> call <span class="idf">createDurableSubscriber</span>. It takes a string as additional argument, which must be a unique name for your subscription. In addition to that, you must also identify your client by setting your client ID.<br/> Now every time you connect with the same combination of strings, you will be connected to the same subscription. Any messages that have been sent to the topic while disconnected will be received when connecting again. To end the subscription <span class="idf">Session</span> provides an <span class="idf">unsubscribe</span> method.</div><div id="pp-d18684e2001" class="tooltip">In order to use durable subscriptions, the client must identify itself in the <span class="idf">Connection</span>. In this case the client ID has been set explicitly.<br/> Alternatively, if you get the <span class="idf">ConnectionFactory</span> via JNDI, your JMS provider may also allow you to to pre-configure a client ID in the <span class="idf">ConnectionFactory</span>. This is often a better solution.</div><div id="pp-d18684e2031" class="tooltip">In order to create a durable subscription you must also specify a name for your subscription (here "s1"). This allows you to re-connect to the same subscription by specifying the same name again.</div><div id="pp-d18684e2094" class="tooltip">Unsubscribes from the durable subscription with the given name. <strong class="warn">You must close your <span class="idf">MessageConsumer</span> before you do this.</strong></div><div id="pp-d18684e1910" class="tooltip"><span class="idf">Non-durable subscription</span> means that you only receive messages sent while you are connected, but not those published while you were offline. If you want them as well you need a <span class="idf">durable</span> subscription, shown later.</div><div id="pp-d18684e2046" class="tooltip">With a <span class="idf">durable</span> subscription your client can receive messages published while the client was offline. It will get them the next time it connects with the same client ID and subscription name.</div><div id="ttCloseBar" class="closeBar"><a href="#" onclick="return tlClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="topicCloseBar" class="closeBar"><a href="#" onclick="return tpcClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div></div></body></html>