<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:page="http://tjansen.de/refPage" xmlns:i="http://tjansen.de/internal"><head><title>How to send a response to a message (Request/Reply) - JMS Guide</title><meta http-equiv="X-UA-Compatible" content="chrome=1"/><meta http-equiv="content-language" content="en"/><link rel="shortcut icon" href="../../images/favicon.png" type="image/png"/><link rel="stylesheet" type="text/css" href="../../style/style.css"/><script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-6791190-2']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
})();
</script><script type="text/javascript" src="../../js/all.js"/></head><body id="body"><div id="visibleContent"><div id="top"><a href="/"><img src="../../images/titlebar.png" alt="Jarfiller.com"/></a></div><div id="main"><div id="bodycolumn"><div class="yahbar"><div class="yahprev"><a href="temporaryqueues.xhtml">Prev</a></div><h3 class="yahhere"><a href="#" onclick="return navToggle();">JMS Guide / How to...</a></h3><div class="yahnext"><a href="deliveryoptions.xhtml">Next</a></div></div><h1 id="sec_howto" class="multipageTitle">How to send a response to a message (Request/Reply)</h1><div class="subSecRow2" id="sec_requestresponse"><div class="subSecHead" id="sechd_requestresponse"><a name="requestresponse">Request / Response</a></div><div class="subSecContent" id="seccnt_requestresponse"><p class="subSecExplanation">In messaging systems it is not that common that the receiver of a message sends a response, but it is possible and JMS supports this with the <em><a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Message.html#getJMSReplyTo()" class="javadoc">JMSReplyTo</a> and <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Message.html#getJMSCorrelationID()" class="javadoc">JMSCorrelationID</a> header fields</em>. Often temporary queues are used to send the reply, but you can also use a regular queue. </p><p class="subSecExplanation">The following snippet sends a message, creates a temporary queue for the response and then waits for it:</p><pre class="subSecCode"><code><a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html" class="javadoc">Session</a> session = <span class="abstract">...</span>;
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Queue.html" class="javadoc">Queue</a> queue = <span class="abstract">...</span>;

<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageProducer.html" class="javadoc">MessageProducer</a> producer = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createProducer(javax.jms.Destination)" class="javadoc">createProducer</a>(queue);
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Queue.html" class="javadoc">Queue</a> tmpQueue = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createTemporaryQueue()" class="javadoc"><em>createTemporaryQueue</em></a>();
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> consumer = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createConsumer(javax.jms.Destination)" class="javadoc">createConsumer</a>(<em>tmpQueue</em>);

<span class="cmt">// Send request</span>
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Message.html" class="javadoc">Message</a> request = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createTextMessage(java.lang.String)" class="javadoc">createTextMessage</a>("how are you?");
request.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Message.html#setJMSReplyTo(javax.jms.Destination)" class="javadoc"><em>setJMSReplyTo</em></a>(<em>tmpQueue</em>);
producer.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageProducer.html#send(javax.jms.Message)" class="javadoc">send</a>(request);

<span class="cmt">// Wait for response</span>
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Message.html" class="javadoc">Message</a> reply = consumer.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html#receive()" class="javadoc">receive</a>();
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/TextMessage.html" class="javadoc">TextMessage</a> tm = (<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/TextMessage.html" class="javadoc">TextMessage</a>) reply;
System.out.println("Got reply: " + tm.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/TextMessage.html#getText()" class="javadoc">getText</a>());
</code></pre><p class="subSecExplanation">This snippet shows how to respond to messages:</p><pre class="subSecCode"><code><a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Connection.html" class="javadoc">Connection</a> con = <span class="abstract">...</span>;
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html" class="javadoc">Session</a> session = <span class="abstract">...</span>;
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Queue.html" class="javadoc">Queue</a> queue = <span class="abstract">...</span>;

<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> consumer = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createConsumer(javax.jms.Destination)" class="javadoc">createConsumer</a>(queue);
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageProducer.html" class="javadoc">MessageProducer</a> producer = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createProducer(javax.jms.Destination)" class="javadoc">createProducer</a>(<em>null</em>);  <span class="cmt">// no default queue (<a href="#" id="tl-d18684e4267" class="dottedTooltip" onclick="return tlClick('tl-d18684e4267','pp-d18684e4267');" onmouseover="return tlOver('tl-d18684e4267','pp-d18684e4267');" onmouseout="return tlOut('tl-d18684e4267','pp-d18684e4267');">more</a>)</span>
con.start();

while (true) {
  <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Message.html" class="javadoc">Message</a> request = consumer.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html#receive()" class="javadoc">receive</a>();
  <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/TextMessage.html" class="javadoc">TextMessage</a> tm = (<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/TextMessage.html" class="javadoc">TextMessage</a>) request;
  System.out.println("Got request: " + tm.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/TextMessage.html#getText()" class="javadoc">getText</a>());

  <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/TextMessage.html" class="javadoc">TextMessage</a> reply = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createTextMessage(java.lang.String)" class="javadoc">createTextMessage</a>("great");
  reply.<a href="http://java.sun.com/javaee/5/docs/apijavax/jms/Message.html#setJMSCorrelationID(java.lang.String)" class="javadoc"><em>setJMSCorrelationID</em></a>(request.<a href="http://java.sun.com/javaee/5/docs/apijavax/jms/Message.html#getJMSMessageID()" class="javadoc">getJMSMessageID</a>());   <span class="cmt">// link messages (<a href="#" id="tl-d18684e4334" class="dottedTooltip" onclick="return tlClick('tl-d18684e4334','pp-d18684e4334');" onmouseover="return tlOver('tl-d18684e4334','pp-d18684e4334');" onmouseout="return tlOut('tl-d18684e4334','pp-d18684e4334');">more</a>)</span>
  producer.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageProducer.html#send(javax.jms.Destination, javax.jms.Message)" class="javadoc"><em>send</em></a>(request.<a href="http://java.sun.com/javaee/5/docs/apijavax/jms/Message.html#getJMSReplyTo()" class="javadoc"><em>getJMSReplyTo</em></a>(), reply);          <span class="cmt">// send reply over temporary queue</span>
}
</code></pre></div></div><div class="yahbar"><div class="yahprev"><a href="temporaryqueues.xhtml">Prev<br/><span>How to Create Temporary Queues or Topics</span></a></div><div class="yahhere"><a href="#" onclick="return navToggle();">JMS Guide / How to...</a><br/><a href="/guide/jms/"><span>Single Page Mode</span></a>, <a href="#" onclick="return navToggle();"><span>Show Table of Content</span></a></div><div class="yahnext"><a href="deliveryoptions.xhtml">Next<br/><span>How to Control Message Delivery (Delivery Mode, Time-to-live and Priority)</span></a></div></div></div><div id="sidecolumn">
    	<div><h3>Useful Links</h3><div class="sidecolumnSubTitleLine"/>
  			<a href="http://java.sun.com/products/jms/">JMS Homepage</a><br/>
  			<a href="http://en.wikipedia.org/wiki/Java_Message_Service">JMS on Wikipedia</a><br/>
  			<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/package-summary.html">javax.jms API Docs</a><br/>
  			<a href="http://java.sun.com/products/jms/docs.html">JMS Specification</a><br/>
  		</div>
  </div></div></div><div id="footer"><div id="footer-content"><div id="footer-left"><div class="footerLine"><a href="/">Home</a> - <a href="/about">About Jarfiller</a> - <a href="/imprint.xhtml">Imprint</a></div><div class="footerLine">Please send feedback and corrections to <a href="mailto:tim@tjansen.de">tim@<span style="display: none">got you</span>tjansen.de</a>.</div><div class="footerLine"><a href="http://www.twitter.com/timjansen">Follow</a> me on Twitter.</div><div class="copyrightLine">© 2010 Tim Jansen; content licensed under <a href="http://creativecommons.org/licenses/by/3.0/us/">cc-by</a>; example source code is public domain
				</div></div><div id="footer-right"><a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="../../images/ext/cc-by-88x31.png"/></a></div></div></div><div id="navbar" onclick="return navToggle();" onmouseover="document.getElementById('navbar').className='mouseover';" onmouseout="document.getElementById('navbar').className='';"/><div id="navcontainer"><div id="navlinks"><div id="navclosebar"><a href="#" onclick="return navClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="navpositionbar" class="navpositionbar"/><h2 id="navtitle">JMS Guide</h2><a id="nav_jmsoverview" class="navseclink" href="jmsoverview.xhtml#jmsoverview">Overview</a><a id="nav_intro" class="navsublink" href="jmsoverview.xhtml#intro">Intro</a><a id="nav_usecases" class="navsublink" href="jmsoverview.xhtml#usecases">When should JMS be used?</a><a id="nav_requirements" class="navsublink" href="jmsoverview.xhtml#requirements">What do you need for JMS?</a><a id="nav_destinations" class="navsublink" href="jmsoverview.xhtml#destinations">Destinations</a><a id="nav_standaloneclient" class="navseclink" href="standaloneclient.xhtml#standaloneclient">Sending and Receiving Messages (Standalone Client)</a><a id="nav_sending" class="navsublink" href="standaloneclient.xhtml#sending">Sending a message</a><a id="nav_polling" class="navsublink" href="standaloneclient.xhtml#polling">Polling for messages</a><a id="nav_messagelistener" class="navsublink" href="standaloneclient.xhtml#messagelistener">Using a MessageListener</a><a id="nav_jndi" class="navsublink" href="standaloneclient.xhtml#jndi">Getting the ConnectionFactory via JNDI</a><a id="nav_activemqsetup" class="navsublink" href="standaloneclient.xhtml#activemqsetup">How to set up ActiveMQ</a><a id="nav_webspheremqsetup" class="navsublink" href="standaloneclient.xhtml#webspheremqsetup">How to set up Websphere MQ</a><a id="nav_sendingreceivingejb3" class="navseclink" href="sendingreceivingejb3.xhtml#sendingreceivingejb3">Sending and Receiving Messages in EJB 3 Applications</a><a id="nav_sendingejb3" class="navsublink" href="sendingreceivingejb3.xhtml#sendingejb3">Sending Messages</a><a id="nav_receivingejb3" class="navsublink" href="sendingreceivingejb3.xhtml#receivingejb3">Receiving messages</a><a id="nav_jbosssetup" class="navsublink" href="sendingreceivingejb3.xhtml#jbosssetup">How to set up JBoss 5.x</a><a id="nav_topics" class="navseclink" href="topics.xhtml#topics">Using Topics</a><a id="nav_sendingtopics" class="navsublink" href="topics.xhtml#sendingtopics">Sending Topic Messages</a><a id="nav_receivingtopics" class="navsublink" href="topics.xhtml#receivingtopics">Receiving Topic Messages</a><a id="nav_durablesubscription" class="navsublink" href="topics.xhtml#durablesubscription">Durable Subscription</a><a id="nav_endingsubscription" class="navsublink" href="topics.xhtml#endingsubscription">Cancelling a subscription</a><a id="nav_messagetypes" class="navseclink" href="messagetypes.xhtml#messagetypes">Message Types</a><a id="nav_textmessages" class="navsublink" href="messagetypes.xhtml#textmessages">TextMessage</a><a id="nav_mapmessages" class="navsublink" href="messagetypes.xhtml#mapmessages">MapMessage</a><a id="nav_streammessages" class="navsublink" href="messagetypes.xhtml#streammessages">StreamMessage</a><a id="nav_objectmessages" class="navsublink" href="messagetypes.xhtml#objectmessages">ObjectMessage</a><a id="nav_bytesmessages" class="navsublink" href="messagetypes.xhtml#bytesmessages">BytesMessage</a><a id="nav_emptymessages" class="navsublink" href="messagetypes.xhtml#emptymessages">Empty Messages</a><span class="navseclink">How to...</span><a id="nav_messageheaders" class="navsublink" href="messageheaders.xhtml#messageheaders">How to use Message Headers</a><a id="nav_messageproperties" class="navsublink" href="messageproperties.xhtml#messageproperties">How to read and set Message Properties</a><a id="nav_selectors" class="navsublink" href="selectors.xhtml#selectors">How to use Message Selectors to filter messages</a><a id="nav_xml" class="navsublink" href="xml.xhtml#xml">How to send and receive XML messages with DOM or JAXB</a><a id="nav_achknowledgement" class="navsublink" href="achknowledgement.xhtml#achknowledgement">How to control acknowledgement</a><a id="nav_browsing" class="navsublink" href="browsing.xhtml#browsing">How to browse the messages in a queue</a><a id="nav_authentication" class="navsublink" href="authentication.xhtml#authentication">How to authenticate a connection</a><a id="nav_temporaryqueues" class="navsublink" href="temporaryqueues.xhtml#temporaryqueues">How to Create Temporary Queues or Topics</a><a id="nav_requestresponse" class="navsublink" href="requestresponse.xhtml#requestresponse">How to send a response to a message (Request/Reply)</a><a id="nav_deliveryoptions" class="navsublink" href="deliveryoptions.xhtml#deliveryoptions">How to Control Message Delivery (Delivery Mode, Time-to-live and Priority)</a><a id="nav_activationproperties" class="navsublink" href="activationproperties.xhtml#activationproperties">How to Configure a Message-Driven Bean (Activation Properties, Durable Subscriptions)</a><a id="nav_concurrency" class="navsublink" href="concurrency.xhtml#concurrency">How to use JMS in multi-threaded applications</a><a id="nav_classes10" class="navsublink" href="classes10.xhtml#classes10">How to Use QueueConnectionFactory, QueueConnection, QueueSession...</a><a id="nav_andnow" class="navseclink" href="andnow.xhtml#andnow">And now...?</a><a id="nav_nextsteps" class="navsublink" href="andnow.xhtml#nextsteps">Next Steps</a></div></div><div id="popups"><div id="pp-d18684e4267" class="tooltip">Actually the <span class="idf">Destination</span> that you pass to the producer is just a default destination. You can create a <span class="idf">MessageProducer</span> without default destination, and use the second <span class="idf">send</span> overload shown below to send to another destination.</div><div id="pp-d18684e4334" class="tooltip">The JMSCorrelationID field allows you to specify that your message is related to the message whose ID you specify. It's up to the client to interpret the field though (in the snippet above the client ignores it).</div><div id="ttCloseBar" class="closeBar"><a href="#" onclick="return tlClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="topicCloseBar" class="closeBar"><a href="#" onclick="return tpcClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div></div></body></html>