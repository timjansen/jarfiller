<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:page="http://tjansen.de/refPage" xmlns:i="http://tjansen.de/internal"><head><title>How to Control Message Delivery (Delivery Mode, Time-to-live and Priority) - JMS Guide</title><meta http-equiv="X-UA-Compatible" content="chrome=1"/><meta http-equiv="content-language" content="en"/><link rel="shortcut icon" href="../../images/favicon.png" type="image/png"/><link rel="stylesheet" type="text/css" href="../../style/style.css"/><script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-6791190-2']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
})();
</script><script type="text/javascript" src="../../js/all.js"/></head><body id="body"><div id="visibleContent"><div id="top"><a href="/"><img src="../../images/titlebar.png" alt="Jarfiller.com"/></a></div><div id="main"><div id="bodycolumn"><div class="yahbar"><div class="yahprev"><a href="requestresponse.xhtml">Prev</a></div><h3 class="yahhere"><a href="#" onclick="return navToggle();">JMS Guide / How to...</a></h3><div class="yahnext"><a href="activationproperties.xhtml">Next</a></div></div><h1 id="sec_howto" class="multipageTitle">How to Control Message Delivery (Delivery Mode, Time-to-live and Priority)</h1><div class="subSecRow1" id="sec_deliveryoptions"><div class="subSecHead" id="sechd_deliveryoptions"><a name="deliveryoptions">Delivery Options</a></div><div class="subSecContent" id="seccnt_deliveryoptions"><p class="subSecExplanation">JMS provides three ways of influencing the delivery of messages: <em>delivery mode, priority and time-to-live</em>.</p><ul class="subSecList"><li> The delivery mode can be either <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/DeliveryMode.html#NON_PERSISTENT" class="javadoc">PERSISTENT</a> or <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/DeliveryMode.html#NON_PERSISTENT" class="javadoc">NON_PERSISTENT</a>. A persistent message's delivery is guaranteed. A non-persistent message may not arrive in some cases, for example when the messaging server is being shut down before the delivery. The advantage of non-persistent messages is that they may be faster.</li><li>Messages with higher priority can arrive earlier than messages with lower priority.</li><li>Time-to-live timeouts can prevent the delivery of messages that are older than a configurable amount of time. </li></ul><p class="subSecExplanation">Delivery mode, priority and timeout are <em>best-effort services</em>. JMS providers should do their best to implement them, but it is not required that they always work as you may expect. For example, JMS allows the delivery of an expired message. </p><p class="subSecExplanation"> In order to set a message's delivery options, there are variants of the <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageProducer.html#send(javax.jms.Message)" class="javadoc">send</a> method that allow setting them for each message. Alternatively you could also set defaults in the <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageProducer.html" class="javadoc">MessageProducer</a>. If you don't do this either, implementation-specific defaults are taken (which can usually be configured somewhere). </p><pre class="subSecCode"><code><a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageProducer.html" class="javadoc">MessageProducer</a> producer = <span class="abstract">...</span>;
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Message.html" class="javadoc">Message</a> msg = <span class="abstract">...</span>;

producer.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageProducer.html#send(javax.jms.Message, int, int, long)" class="javadoc">send</a>(msg, 
              <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/DeliveryMode.html#NON_PERSISTENT" class="javadoc"><em>DeliveryMode.NON_PERSISTENT</em></a>,  <span class="cmt">// delivery mode</span>
              <em>4</em>,                            <span class="cmt">// priority (0-9, 9 is highest)</span>
              <em>1000*60</em>);                     <span class="cmt">// time-to-live in milliseconds(here: 60 seconds)</span>
</code></pre><p class="subSecExplanation"> The receiver can find out with which options a message has been sent by looking at the <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Message.html#getJMSDeliveryMode()" class="javadoc">JMSDeliveryMode</a>, <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Message.html#getJMSExpiration()" class="javadoc">JMSExpiration</a> and <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Message.html#getJMSPriority()" class="javadoc">JMSPriority</a> header fields. </p></div></div><div class="yahbar"><div class="yahprev"><a href="requestresponse.xhtml">Prev<br/><span>How to send a response to a message (Request/Reply)</span></a></div><div class="yahhere"><a href="#" onclick="return navToggle();">JMS Guide / How to...</a><br/><a href="/guide/jms/"><span>Single Page Mode</span></a>, <a href="#" onclick="return navToggle();"><span>Show Table of Content</span></a></div><div class="yahnext"><a href="activationproperties.xhtml">Next<br/><span>How to Configure a Message-Driven Bean (Activation Properties, Durable Subscriptions)</span></a></div></div></div><div id="sidecolumn">
    	<div><h3>Useful Links</h3><div class="sidecolumnSubTitleLine"/>
  			<a href="http://java.sun.com/products/jms/">JMS Homepage</a><br/>
  			<a href="http://en.wikipedia.org/wiki/Java_Message_Service">JMS on Wikipedia</a><br/>
  			<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/package-summary.html">javax.jms API Docs</a><br/>
  			<a href="http://java.sun.com/products/jms/docs.html">JMS Specification</a><br/>
  		</div>
  </div></div></div><div id="footer"><div id="footer-content"><div id="footer-left"><div class="footerLine"><a href="/">Home</a> - <a href="/about">About Jarfiller</a> - <a href="/imprint.xhtml">Imprint</a></div><div class="footerLine">Please send feedback and corrections to <a href="mailto:tim@tjansen.de">tim@<span style="display: none">got you</span>tjansen.de</a>.</div><div class="footerLine"><a href="http://www.twitter.com/timjansen">Follow</a> me on Twitter.</div><div class="copyrightLine">Â© 2010 Tim Jansen; content licensed under <a href="http://creativecommons.org/licenses/by/3.0/us/">cc-by</a>; example source code is public domain
				</div></div><div id="footer-right"><a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="../../images/ext/cc-by-88x31.png"/></a></div></div></div><div id="navbar" onclick="return navToggle();" onmouseover="document.getElementById('navbar').className='mouseover';" onmouseout="document.getElementById('navbar').className='';"/><div id="navcontainer"><div id="navlinks"><div id="navclosebar"><a href="#" onclick="return navClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="navpositionbar" class="navpositionbar"/><h2 id="navtitle">JMS Guide</h2><a id="nav_jmsoverview" class="navseclink" href="jmsoverview.xhtml#jmsoverview">Overview</a><a id="nav_intro" class="navsublink" href="jmsoverview.xhtml#intro">Intro</a><a id="nav_usecases" class="navsublink" href="jmsoverview.xhtml#usecases">When should JMS be used?</a><a id="nav_requirements" class="navsublink" href="jmsoverview.xhtml#requirements">What do you need for JMS?</a><a id="nav_destinations" class="navsublink" href="jmsoverview.xhtml#destinations">Destinations</a><a id="nav_standaloneclient" class="navseclink" href="standaloneclient.xhtml#standaloneclient">Sending and Receiving Messages (Standalone Client)</a><a id="nav_sending" class="navsublink" href="standaloneclient.xhtml#sending">Sending a message</a><a id="nav_polling" class="navsublink" href="standaloneclient.xhtml#polling">Polling for messages</a><a id="nav_messagelistener" class="navsublink" href="standaloneclient.xhtml#messagelistener">Using a MessageListener</a><a id="nav_jndi" class="navsublink" href="standaloneclient.xhtml#jndi">Getting the ConnectionFactory via JNDI</a><a id="nav_activemqsetup" class="navsublink" href="standaloneclient.xhtml#activemqsetup">How to set up ActiveMQ</a><a id="nav_webspheremqsetup" class="navsublink" href="standaloneclient.xhtml#webspheremqsetup">How to set up Websphere MQ</a><a id="nav_sendingreceivingejb3" class="navseclink" href="sendingreceivingejb3.xhtml#sendingreceivingejb3">Sending and Receiving Messages in EJB 3 Applications</a><a id="nav_sendingejb3" class="navsublink" href="sendingreceivingejb3.xhtml#sendingejb3">Sending Messages</a><a id="nav_receivingejb3" class="navsublink" href="sendingreceivingejb3.xhtml#receivingejb3">Receiving messages</a><a id="nav_jbosssetup" class="navsublink" href="sendingreceivingejb3.xhtml#jbosssetup">How to set up JBoss 5.x</a><a id="nav_topics" class="navseclink" href="topics.xhtml#topics">Using Topics</a><a id="nav_sendingtopics" class="navsublink" href="topics.xhtml#sendingtopics">Sending Topic Messages</a><a id="nav_receivingtopics" class="navsublink" href="topics.xhtml#receivingtopics">Receiving Topic Messages</a><a id="nav_durablesubscription" class="navsublink" href="topics.xhtml#durablesubscription">Durable Subscription</a><a id="nav_endingsubscription" class="navsublink" href="topics.xhtml#endingsubscription">Cancelling a subscription</a><a id="nav_messagetypes" class="navseclink" href="messagetypes.xhtml#messagetypes">Message Types</a><a id="nav_textmessages" class="navsublink" href="messagetypes.xhtml#textmessages">TextMessage</a><a id="nav_mapmessages" class="navsublink" href="messagetypes.xhtml#mapmessages">MapMessage</a><a id="nav_streammessages" class="navsublink" href="messagetypes.xhtml#streammessages">StreamMessage</a><a id="nav_objectmessages" class="navsublink" href="messagetypes.xhtml#objectmessages">ObjectMessage</a><a id="nav_bytesmessages" class="navsublink" href="messagetypes.xhtml#bytesmessages">BytesMessage</a><a id="nav_emptymessages" class="navsublink" href="messagetypes.xhtml#emptymessages">Empty Messages</a><span class="navseclink">How to...</span><a id="nav_messageheaders" class="navsublink" href="messageheaders.xhtml#messageheaders">How to use Message Headers</a><a id="nav_messageproperties" class="navsublink" href="messageproperties.xhtml#messageproperties">How to read and set Message Properties</a><a id="nav_selectors" class="navsublink" href="selectors.xhtml#selectors">How to use Message Selectors to filter messages</a><a id="nav_xml" class="navsublink" href="xml.xhtml#xml">How to send and receive XML messages with DOM or JAXB</a><a id="nav_achknowledgement" class="navsublink" href="achknowledgement.xhtml#achknowledgement">How to control acknowledgement</a><a id="nav_browsing" class="navsublink" href="browsing.xhtml#browsing">How to browse the messages in a queue</a><a id="nav_authentication" class="navsublink" href="authentication.xhtml#authentication">How to authenticate a connection</a><a id="nav_temporaryqueues" class="navsublink" href="temporaryqueues.xhtml#temporaryqueues">How to Create Temporary Queues or Topics</a><a id="nav_requestresponse" class="navsublink" href="requestresponse.xhtml#requestresponse">How to send a response to a message (Request/Reply)</a><a id="nav_deliveryoptions" class="navsublink" href="deliveryoptions.xhtml#deliveryoptions">How to Control Message Delivery (Delivery Mode, Time-to-live and Priority)</a><a id="nav_activationproperties" class="navsublink" href="activationproperties.xhtml#activationproperties">How to Configure a Message-Driven Bean (Activation Properties, Durable Subscriptions)</a><a id="nav_concurrency" class="navsublink" href="concurrency.xhtml#concurrency">How to use JMS in multi-threaded applications</a><a id="nav_classes10" class="navsublink" href="classes10.xhtml#classes10">How to Use QueueConnectionFactory, QueueConnection, QueueSession...</a><a id="nav_andnow" class="navseclink" href="andnow.xhtml#andnow">And now...?</a><a id="nav_nextsteps" class="navsublink" href="andnow.xhtml#nextsteps">Next Steps</a></div></div><div id="popups"><div id="ttCloseBar" class="closeBar"><a href="#" onclick="return tlClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="topicCloseBar" class="closeBar"><a href="#" onclick="return tpcClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div></div></body></html>