<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:page="http://tjansen.de/refPage" xmlns:i="http://tjansen.de/internal"><head><title>How to use Message Selectors to filter messages - JMS Guide</title><meta http-equiv="X-UA-Compatible" content="chrome=1"/><meta http-equiv="content-language" content="en"/><link rel="shortcut icon" href="../../images/favicon.png" type="image/png"/><link rel="stylesheet" type="text/css" href="../../style/style.css"/><script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-6791190-2']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
})();
</script><script type="text/javascript" src="../../js/all.js"/></head><body id="body"><div id="visibleContent"><div id="top"><a href="/"><img src="../../images/titlebar.png" alt="Jarfiller.com"/></a></div><div id="main"><div id="bodycolumn"><div class="yahbar"><div class="yahprev"><a href="messageproperties.xhtml">Prev</a></div><h3 class="yahhere"><a href="#" onclick="return navToggle();">JMS Guide / How to...</a></h3><div class="yahnext"><a href="xml.xhtml">Next</a></div></div><h1 id="sec_howto" class="multipageTitle">How to use Message Selectors to filter messages</h1><div class="subSecRow2" id="sec_selectors"><div class="subSecHead" id="sechd_selectors"><a name="selectors">Message Selectors</a></div><div class="subSecContent" id="seccnt_selectors"><p class="subSecExplanation"><span class="idf">Message Selectors</span> allow you to <em>filter the messages that a <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> will receive</em>. The filter is a relatively complex language that mimics the <em>syntax of an SQL WHERE clause</em>. The selector can use all message headers and properties for filtering, but can not use the message content.<br/> Selectors are mostly useful for <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Topic.html" class="javadoc">Topic</a>s that broadcast a very large number of messages to its subscribers.</p><p class="subSecExplanation">They way selectors work depends on the destination type:</p><ul class="subSecList"><li>On <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Queue.html" class="javadoc">Queue</a>s, only messages that match the selector will be returned. Others stay in the queue (and thus can be read by a <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> with different selector).</li><li>On <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Topic.html" class="javadoc">Topic</a>s, messages that do not match the selector will be ignored as if they have not been published.</li></ul><p class="subSecExplanation"> In order to create a selection, you need to pass it to the <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createConsumer(javax.jms.Destination, java.lang.String)" class="javadoc">createConsumer</a> or <a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createDurableSubscriber(javax.jms.Topic, java.lang.String, java.lang.String, boolean)" class="javadoc">createDurableSubscriber</a> invocation: </p><pre class="subSecCode"><code><a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html" class="javadoc">Session</a> session = <span class="abstract">...</span>
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> consumer = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createConsumer(javax.jms.Destination, java.lang.String)" class="javadoc">createConsumer</a>(queue, "<em>releaseYear &lt; 1980</em>");
</code></pre><p class="subSecExplanation">The following SQL elements are allowed in the filter:</p><div class="subSecTableDiv"><table><tr><th>Element</th><th>Description</th><th>Example Selector</th></tr><tr><td>Header Fields</td><td>Any headers except <span class="idf">JMSDestination</span>, <span class="idf">JMSExpiration</span> and <span class="idf">JMSReplyTo</span></td><td><em>JMSPriority</em> = 9</td></tr><tr><td>Properties</td><td>Message properties that follow Java identifier naming</td><td><em>releaseYear</em> = 1982</td></tr><tr><td>String Literals</td><td>String literals in single quotes, duplicate to escape </td><td>title = <em>'Sam''s'</em></td></tr><tr><td>Number Literals</td><td>Numbers in Java syntax (int and double)</td><td>releaseYear = <em>1982</em></td></tr><tr><td>Boolean Literals</td><td><span class="idf">TRUE</span> and <span class="idf">FALSE</span></td><td>isAvailable = <em>TRUE</em></td></tr><tr><td>( )</td><td>Brackets</td><td><em>(</em>releaseYear &lt; 1980<em>)</em> OR <em>(</em>releaseYear &gt; 1989<em>)</em></td></tr><tr><td><span class="idf">AND</span>, <span class="idf">OR</span>, <span class="idf">NOT</span></td><td>Logical operators</td><td>(releaseYear &lt; 1980) <em>AND NOT</em> (title = 'Thriller')</td></tr><tr><td>=, &lt;&gt;, &lt;, &lt;=, &gt;, &gt;=</td><td>Comparison operators</td><td>(releaseYear <em>&lt;</em> 1980) AND (title <em>&lt;&gt;</em> 'Thriller')</td></tr><tr><td><span class="idf">LIKE</span></td><td>String comparison with wildcards '_' and '%' (<a href="#" id="tl-d18684e3211" class="dottedTooltip" onclick="return tlClick('tl-d18684e3211','pp-d18684e3211');" onmouseover="return tlOver('tl-d18684e3211','pp-d18684e3211');" onmouseout="return tlOut('tl-d18684e3211','pp-d18684e3211');">more</a>)</td><td>title <em>LIKE</em> 'Thrill<em>%</em>'</td></tr><tr><td><span class="idf">IN</span></td><td>Find value in set of strings (<a href="#" id="tl-d18684e3232" class="dottedTooltip" onclick="return tlClick('tl-d18684e3232','pp-d18684e3232');" onmouseover="return tlOver('tl-d18684e3232','pp-d18684e3232');" onmouseout="return tlOut('tl-d18684e3232','pp-d18684e3232');">more</a>)</td><td>title <em>IN</em> ('Off the wall', 'Thriller', 'Bad')</td></tr><tr><td><span class="idf">BETWEEN</span></td><td>Check whether number is in range (both numbers inclusive) (<a href="#" id="tl-d18684e3262" class="dottedTooltip" onclick="return tlClick('tl-d18684e3262','pp-d18684e3262');" onmouseover="return tlOver('tl-d18684e3262','pp-d18684e3262');" onmouseout="return tlOut('tl-d18684e3262','pp-d18684e3262');">more</a>)</td><td>releaseYear <em>BETWEEN</em> 1980 <em>AND</em> 1989</td></tr><tr><td><span class="idf">IS NULL</span>, <span class="idf">IS NOT NULL</span></td><td>Check whether value is null or not null.</td><td>releaseYear <em>IS NOT NULL</em></td></tr><tr><td>*, +, -, /</td><td>Arithmetic operators</td><td>releaseYear <em>*</em> 2 &gt; 2000 <em>-</em> 20</td></tr></table></div><p class="subSecExplanation"> Some more examples of message consumers with selectors: </p><pre class="subSecCode"><code><a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html" class="javadoc">Session</a> session = <span class="abstract">...</span>
<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> consumer1 = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createConsumer(javax.jms.Destination, java.lang.String)" class="javadoc">createConsumer</a>(queue, 
                       "(releaseYear &lt; 1980) OR (releaseYear &gt; 1989)");

<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> consumer2 = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createConsumer(javax.jms.Destination, java.lang.String)" class="javadoc">createConsumer</a>(queue, 
                       "(releaseYear BETWEEN 1980 AND 1989) AND title LIKE 'Michael%'");

<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> consumer3 = session.<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/Session.html#createConsumer(javax.jms.Destination, java.lang.String)" class="javadoc">createConsumer</a>(queue, 
                       "(releaseYear = 1982) OR (title = 'Thriller')");

<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/MessageConsumer.html" class="javadoc">MessageConsumer</a> consumer4 = session.<a href="http://java.sun.com/javaee/5/docs/api/api/javax/jms/Session.html#createDurableSubscriber(javax.jms.Topic, java.lang.String, java.lang.String, boolean)" class="javadoc">createDurableConsumer</a>(queue, 
                       "title IN ('Off the wall', 'Thriller', 'Bad')");
</code></pre></div></div><div class="yahbar"><div class="yahprev"><a href="messageproperties.xhtml">Prev<br/><span>How to read and set Message Properties</span></a></div><div class="yahhere"><a href="#" onclick="return navToggle();">JMS Guide / How to...</a><br/><a href="/guide/jms/"><span>Single Page Mode</span></a>, <a href="#" onclick="return navToggle();"><span>Show Table of Content</span></a></div><div class="yahnext"><a href="xml.xhtml">Next<br/><span>How to send and receive XML messages with DOM or JAXB</span></a></div></div></div><div id="sidecolumn">
    	<div><h3>Useful Links</h3><div class="sidecolumnSubTitleLine"/>
  			<a href="http://java.sun.com/products/jms/">JMS Homepage</a><br/>
  			<a href="http://en.wikipedia.org/wiki/Java_Message_Service">JMS on Wikipedia</a><br/>
  			<a href="http://java.sun.com/javaee/5/docs/api/javax/jms/package-summary.html">javax.jms API Docs</a><br/>
  			<a href="http://java.sun.com/products/jms/docs.html">JMS Specification</a><br/>
  		</div>
  </div></div></div><div id="footer"><div id="footer-content"><div id="footer-left"><div class="footerLine"><a href="/">Home</a> - <a href="/about">About Jarfiller</a> - <a href="/imprint.xhtml">Imprint</a></div><div class="footerLine">Please send feedback and corrections to <a href="mailto:tim@tjansen.de">tim@<span style="display: none">got you</span>tjansen.de</a>.</div><div class="footerLine"><a href="http://www.twitter.com/timjansen">Follow</a> me on Twitter.</div><div class="copyrightLine">Â© 2010 Tim Jansen; content licensed under <a href="http://creativecommons.org/licenses/by/3.0/us/">cc-by</a>; example source code is public domain
				</div></div><div id="footer-right"><a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="../../images/ext/cc-by-88x31.png"/></a></div></div></div><div id="navbar" onclick="return navToggle();" onmouseover="document.getElementById('navbar').className='mouseover';" onmouseout="document.getElementById('navbar').className='';"/><div id="navcontainer"><div id="navlinks"><div id="navclosebar"><a href="#" onclick="return navClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="navpositionbar" class="navpositionbar"/><h2 id="navtitle">JMS Guide</h2><a id="nav_jmsoverview" class="navseclink" href="jmsoverview.xhtml#jmsoverview">Overview</a><a id="nav_intro" class="navsublink" href="jmsoverview.xhtml#intro">Intro</a><a id="nav_usecases" class="navsublink" href="jmsoverview.xhtml#usecases">When should JMS be used?</a><a id="nav_requirements" class="navsublink" href="jmsoverview.xhtml#requirements">What do you need for JMS?</a><a id="nav_destinations" class="navsublink" href="jmsoverview.xhtml#destinations">Destinations</a><a id="nav_standaloneclient" class="navseclink" href="standaloneclient.xhtml#standaloneclient">Sending and Receiving Messages (Standalone Client)</a><a id="nav_sending" class="navsublink" href="standaloneclient.xhtml#sending">Sending a message</a><a id="nav_polling" class="navsublink" href="standaloneclient.xhtml#polling">Polling for messages</a><a id="nav_messagelistener" class="navsublink" href="standaloneclient.xhtml#messagelistener">Using a MessageListener</a><a id="nav_jndi" class="navsublink" href="standaloneclient.xhtml#jndi">Getting the ConnectionFactory via JNDI</a><a id="nav_activemqsetup" class="navsublink" href="standaloneclient.xhtml#activemqsetup">How to set up ActiveMQ</a><a id="nav_webspheremqsetup" class="navsublink" href="standaloneclient.xhtml#webspheremqsetup">How to set up Websphere MQ</a><a id="nav_sendingreceivingejb3" class="navseclink" href="sendingreceivingejb3.xhtml#sendingreceivingejb3">Sending and Receiving Messages in EJB 3 Applications</a><a id="nav_sendingejb3" class="navsublink" href="sendingreceivingejb3.xhtml#sendingejb3">Sending Messages</a><a id="nav_receivingejb3" class="navsublink" href="sendingreceivingejb3.xhtml#receivingejb3">Receiving messages</a><a id="nav_jbosssetup" class="navsublink" href="sendingreceivingejb3.xhtml#jbosssetup">How to set up JBoss 5.x</a><a id="nav_topics" class="navseclink" href="topics.xhtml#topics">Using Topics</a><a id="nav_sendingtopics" class="navsublink" href="topics.xhtml#sendingtopics">Sending Topic Messages</a><a id="nav_receivingtopics" class="navsublink" href="topics.xhtml#receivingtopics">Receiving Topic Messages</a><a id="nav_durablesubscription" class="navsublink" href="topics.xhtml#durablesubscription">Durable Subscription</a><a id="nav_endingsubscription" class="navsublink" href="topics.xhtml#endingsubscription">Cancelling a subscription</a><a id="nav_messagetypes" class="navseclink" href="messagetypes.xhtml#messagetypes">Message Types</a><a id="nav_textmessages" class="navsublink" href="messagetypes.xhtml#textmessages">TextMessage</a><a id="nav_mapmessages" class="navsublink" href="messagetypes.xhtml#mapmessages">MapMessage</a><a id="nav_streammessages" class="navsublink" href="messagetypes.xhtml#streammessages">StreamMessage</a><a id="nav_objectmessages" class="navsublink" href="messagetypes.xhtml#objectmessages">ObjectMessage</a><a id="nav_bytesmessages" class="navsublink" href="messagetypes.xhtml#bytesmessages">BytesMessage</a><a id="nav_emptymessages" class="navsublink" href="messagetypes.xhtml#emptymessages">Empty Messages</a><span class="navseclink">How to...</span><a id="nav_messageheaders" class="navsublink" href="messageheaders.xhtml#messageheaders">How to use Message Headers</a><a id="nav_messageproperties" class="navsublink" href="messageproperties.xhtml#messageproperties">How to read and set Message Properties</a><a id="nav_selectors" class="navsublink" href="selectors.xhtml#selectors">How to use Message Selectors to filter messages</a><a id="nav_xml" class="navsublink" href="xml.xhtml#xml">How to send and receive XML messages with DOM or JAXB</a><a id="nav_achknowledgement" class="navsublink" href="achknowledgement.xhtml#achknowledgement">How to control acknowledgement</a><a id="nav_browsing" class="navsublink" href="browsing.xhtml#browsing">How to browse the messages in a queue</a><a id="nav_authentication" class="navsublink" href="authentication.xhtml#authentication">How to authenticate a connection</a><a id="nav_temporaryqueues" class="navsublink" href="temporaryqueues.xhtml#temporaryqueues">How to Create Temporary Queues or Topics</a><a id="nav_requestresponse" class="navsublink" href="requestresponse.xhtml#requestresponse">How to send a response to a message (Request/Reply)</a><a id="nav_deliveryoptions" class="navsublink" href="deliveryoptions.xhtml#deliveryoptions">How to Control Message Delivery (Delivery Mode, Time-to-live and Priority)</a><a id="nav_activationproperties" class="navsublink" href="activationproperties.xhtml#activationproperties">How to Configure a Message-Driven Bean (Activation Properties, Durable Subscriptions)</a><a id="nav_concurrency" class="navsublink" href="concurrency.xhtml#concurrency">How to use JMS in multi-threaded applications</a><a id="nav_classes10" class="navsublink" href="classes10.xhtml#classes10">How to Use QueueConnectionFactory, QueueConnection, QueueSession...</a><a id="nav_andnow" class="navseclink" href="andnow.xhtml#andnow">And now...?</a><a id="nav_nextsteps" class="navsublink" href="andnow.xhtml#nextsteps">Next Steps</a></div></div><div id="popups"><div id="pp-d18684e3211" class="tooltip">'_' stands for a single character. '%' stands for any sequence of characters, including an empty sequence. Both wildcards can be anywhere in the string.</div><div id="pp-d18684e3232" class="tooltip">The <span class="idf">IN</span> operator allows you to specify a set of strings. It returns true only if the first operand is in the set.<br/> <strong class="warn">Note!</strong> The <span class="idf">IN</span> operator works only on sets of strings, not on numbers.</div><div id="pp-d18684e3262" class="tooltip">The <span class="idf">BETWEEN</span> operator allows you to check whether the first operand is between two numbers. "a BETWEEN n AND m" is equivalent to "a &gt;= n AND a &lt;= m". <strong class="warn">Note!</strong> The <span class="idf">BETWEEN</span> operator works on numbers, not strings.</div><div id="ttCloseBar" class="closeBar"><a href="#" onclick="return tlClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="topicCloseBar" class="closeBar"><a href="#" onclick="return tpcClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div></div></body></html>