<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:page="http://tjansen.de/refPage" xmlns:i="http://tjansen.de/internal"><head><title>How to Customize the Serialization / use JAXB 2.0 - JAXB Guide</title><meta http-equiv="X-UA-Compatible" content="chrome=1"/><meta http-equiv="content-language" content="en"/><link rel="shortcut icon" href="../../images/favicon.png" type="image/png"/><link rel="stylesheet" type="text/css" href="../../style/style.css"/><script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-6791190-2']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
})();
</script><script type="text/javascript" src="../../js/all.js"/></head><body id="body"><div id="visibleContent"><div id="top"><a href="/"><img src="../../images/titlebar.png" alt="Jarfiller.com"/></a></div><div id="main"><div id="bodycolumn"><div class="yahbar"><div class="yahprev"><a href="jaxbcontext.xhtml">Prev</a></div><h3 class="yahhere"><a href="#" onclick="return navToggle();">JAXB Guide / How to... Serialization</a></h3><div class="yahnext"><a href="schemavalidation.xhtml">Next</a></div></div><h1 id="sec_howtoserialization" class="multipageTitle">How to Customize the Serialization / use JAXB 2.0</h1><div class="subSecRow2" id="sec_customizedserialization"><div class="subSecHead" id="sechd_customizedserialization"><a name="customizedserialization">Marshaller / Unmarshaller</a></div><div class="subSecContent" id="seccnt_customizedserialization"><p class="subSecExplanation">Using the methods <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXB.html#marshal(java.lang.Object, java.io.Writer)" class="javadoc">JAXB.marshal</a> and <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXB.html#unmarshal(java.io.File, java.lang.Class)" class="javadoc">JAXB.unmarshall</a>, as shown in the previous sections, is the most convenient way of using JAXB. Unfortunately, they do no allow any customization of the serialization and deserialization processes, and they are not available JAXB 2.0. In order to get around these limitations, you have to work with the <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBContext.html" class="javadoc">JAXBContext</a>, <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Marshaller.html" class="javadoc">Marshaller</a> and <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Unmarshaller.html" class="javadoc">Unmarshaller</a> objects. <br/> The following example shows you how to write a Java object into an XML document using <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Marshaller.html" class="javadoc">Marshaller</a>:</p><pre class="subSecCode"><code>MovieLibrary library = <span class="abstract">...</span>;

<a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBContext.html" class="javadoc">JAXBContext</a> ctx = <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBContext.html#newInstance(java.lang.Class...)" class="javadoc">JAXBContext.newInstance</a>(MovieLibrary.class);  <span class="cmt">// create <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBContext.html" class="javadoc">JAXBContext</a> (<a href="#" id="tl-d2e3413" class="dottedTooltip" onclick="return tlClick('tl-d2e3413','pp-d2e3413');" onmouseover="return tlOver('tl-d2e3413','pp-d2e3413');" onmouseout="return tlOut('tl-d2e3413','pp-d2e3413');">more</a>)</span>
<a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Marshaller.html" class="javadoc">Marshaller</a> marshaller = ctx.<a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBContext.html#createMarshaller()" class="javadoc">createMarshaller</a>();
marshaller.<a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Marshaller.html#marshal(java.lang.Object, java.io.OutputStream)" class="javadoc">marshal</a>(library, new FileOutputStream("/tmp/library.xml"));
</code></pre><p class="subSecExplanation">Note that the example above only works if you declared the <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/annotation/XmlRootElement.html" class="javadoc">@XmlRootElement</a> for the <span class="idf">MovieLibrary</span> class. This shouldn't be a problem for classes you wrote yourself. However, the <a href="#" id="tl-d2e3451" class="dottedTooltip" onclick="return tlClick('tl-d2e3451','pp-d2e332');" onmouseover="return tlOver('tl-d2e3451','pp-d2e332');" onmouseout="return tlOut('tl-d2e3451','pp-d2e332');">xjc</a> compiler does not set it automatically under some circumstances (<a href="#" id="tl-d2e3453" class="dottedTooltip" onclick="return tlClick('tl-d2e3453','pp-d2e3453');" onmouseover="return tlOver('tl-d2e3453','pp-d2e3453');" onmouseout="return tlOut('tl-d2e3453','pp-d2e3453');">more</a>). In this case you must set the root element's name explicitly and the <span class="idf">marshal</span> call looks like this:</p><pre class="subSecCode"><code>marshaller.<a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Marshaller.html#marshal(java.lang.Object, java.io.OutputStream)" class="javadoc">marshal</a>(<em><a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBElement.html#JAXBElement(javax.xml.namespace.QName, java.lang.Class, T)" class="javadoc">new JAXBElement</a>&lt;MovieLibrary&gt;(new QName("movieLibrary"),</em> 
                                                    <em>MovieLibrary.class, library)</em>,
                   new FileOutputStream("/tmp/library.xml"));
</code></pre><p class="subSecExplanation">Loading XML with the <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Unmarshaller.html" class="javadoc">Unmarshaller</a> is similar to storing: </p><pre class="subSecCode"><code><a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBContext.html" class="javadoc">JAXBContext</a> ctx = <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBContext.html#newInstance(java.lang.Class...)" class="javadoc">JAXBContext.newInstance</a>(MovieLibrary.class);  <span class="cmt">// can be reused</span>
<a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Unmarshaller.html" class="javadoc">Unmarshaller</a> unmarshaller = ctx.<a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBContext.html#createUnmarshaller()" class="javadoc">createUnmarshaller</a>();
MovieLibrary library = unmarshaller.<a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Unmarshaller.html#unmarshal(javax.xml.transform.Source, java.lang.Class)" class="javadoc">unmarshal</a>(<a href="http://java.sun.com/javase/6/docs/api/javax/xml/transform/stream/StreamSource.html#StreamSource(java.io.File)" class="javadoc">new StreamSource</a>(new File("/tmp/library.xml")),
                                              MovieLibrary.class).<a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBElement.html#getValue()" class="javadoc">getValue</a>();
</code></pre></div></div><div class="yahbar"><div class="yahprev"><a href="jaxbcontext.xhtml">Prev<br/><span>How to Use JAXBContext</span></a></div><div class="yahhere"><a href="#" onclick="return navToggle();">JAXB Guide / How to... Serialization</a><br/><a href="/guide/jaxb/"><span>Single Page Mode</span></a>, <a href="#" onclick="return navToggle();"><span>Show Table of Content</span></a></div><div class="yahnext"><a href="schemavalidation.xhtml">Next<br/><span>How to Validate Against an XML Schema</span></a></div></div></div><div id="sidecolumn">
  	<div><h3>Useful Links</h3><div class="sidecolumnSubTitleLine"/>
  			<a href="http://en.wikipedia.org/wiki/Java_Architecture_for_XML_Binding">JAXB on Wikipedia</a><br/>
  			<a href="https://jaxb.dev.java.net/">JAXB Reference Implementation (Metro)</a><br/>
  			<a href="http://jcp.org/en/jsr/detail?id=222">JSR-222 (JAXB)</a><br/>
  			<a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/package-summary.html">Java 6 API javax.xml.bind</a>
  		</div>
  </div></div></div><div id="footer"><div id="footer-content"><div id="footer-left"><div class="footerLine"><a href="/">Home</a> - <a href="/about">About Jarfiller</a> - <a href="/imprint.xhtml">Imprint</a></div><div class="footerLine">Please send feedback and corrections to <a href="mailto:tim@tjansen.de">tim@<span style="display: none">got you</span>tjansen.de</a>.</div><div class="footerLine"><a href="http://www.twitter.com/timjansen">Follow</a> me on Twitter.</div><div class="copyrightLine">Â© 2010 Tim Jansen; content licensed under <a href="http://creativecommons.org/licenses/by/3.0/us/">cc-by</a>; example source code is public domain
				</div></div><div id="footer-right"><a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="../../images/ext/cc-by-88x31.png"/></a></div></div></div><div id="navbar" onclick="return navToggle();" onmouseover="document.getElementById('navbar').className='mouseover';" onmouseout="document.getElementById('navbar').className='';"/><div id="navcontainer"><div id="navlinks"><div id="navclosebar"><a href="#" onclick="return navClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="navpositionbar" class="navpositionbar"/><h2 id="navtitle">JAXB Guide</h2><a id="nav_jaxboverview" class="navseclink" href="jaxboverview.xhtml#jaxboverview">Overview</a><a id="nav_intro" class="navsublink" href="jaxboverview.xhtml#intro">Intro</a><a id="nav_usecases" class="navsublink" href="jaxboverview.xhtml#usecases">When should JAXB be used?</a><a id="nav_requirements" class="navsublink" href="jaxboverview.xhtml#requirements">What do you need for JAXB?</a><a id="nav_mappingclasses" class="navseclink" href="mappingclasses.xhtml#mappingclasses">Mapping Classes</a><a id="nav_schemafirst" class="navsublink" href="mappingclasses.xhtml#schemafirst">Schema first?</a><a id="nav_xjc" class="navsublink" href="mappingclasses.xhtml#xjc">xjc</a><a id="nav_propertybased" class="navsublink" href="mappingclasses.xhtml#propertybased">Property-based Beans</a><a id="nav_fieldbased" class="navsublink" href="mappingclasses.xhtml#fieldbased">Field-based beans</a><a id="nav_exampleschema" class="navsublink" href="mappingclasses.xhtml#exampleschema">XML Schema</a><a id="nav_readingandwriting" class="navseclink" href="readingandwriting.xhtml#readingandwriting">Reading and Writing XML</a><a id="nav_writingxml" class="navsublink" href="readingandwriting.xhtml#writingxml">Writing XML</a><a id="nav_writingxmlresult" class="navsublink" href="readingandwriting.xhtml#writingxmlresult">Result</a><a id="nav_readingxml" class="navsublink" href="readingandwriting.xhtml#readingxml">Reading XML</a><a id="nav_supportedtypes" class="navsublink" href="readingandwriting.xhtml#supportedtypes">Supported Types</a><span class="navseclink">How to... Mapping</span><a id="nav_namespaces" class="navsublink" href="namespaces.xhtml#namespaces">How to Use XML Namespaces</a><a id="nav_attributes" class="navsublink" href="attributes.xhtml#attributes">How to Declare XML Attributes</a><a id="nav_requiredelements" class="navsublink" href="requiredelements.xhtml#requiredelements">How to Require XML Elements</a><a id="nav_elementnames" class="navsublink" href="elementnames.xhtml#elementnames">How to Specify a Different Name for an Element</a><a id="nav_preventingserialization" class="navsublink" href="preventingserialization.xhtml#preventingserialization">How to Prevent Serialization of Properties or Fields</a><a id="nav_propertyorder" class="navsublink" href="propertyorder.xhtml#propertyorder">How to Specify an Order for Properties/Fields</a><a id="nav_choice" class="navsublink" href="choice.xhtml#choice">How to Have Mixed XML Elements in a Single List (Choice)</a><a id="nav_simpletypes" class="navsublink" href="simpletypes.xhtml#simpletypes">How to Implement a Simple Type</a><a id="nav_xmladapter" class="navsublink" href="xmladapter.xhtml#xmladapter">How to Map Java Types to XML</a><a id="nav_jaxbelement" class="navsublink" href="jaxbelement.xhtml#jaxbelement">How to use JAXBElement</a><span class="navseclink">How to... Serialization</span><a id="nav_jaxbcontext" class="navsublink" href="jaxbcontext.xhtml#jaxbcontext">How to Use JAXBContext</a><a id="nav_customizedserialization" class="navsublink" href="customizedserialization.xhtml#customizedserialization">How to Customize the Serialization / use JAXB 2.0</a><a id="nav_schemavalidation" class="navsublink" href="schemavalidation.xhtml#schemavalidation">How to Validate Against an XML Schema</a><a id="nav_prettyprinting" class="navsublink" href="prettyprinting.xhtml#prettyprinting">How to Create Nicely Formatted XML</a><a id="nav_xmlfragments" class="navsublink" href="xmlfragments.xhtml#xmlfragments">How to Create XML Fragments</a><a id="nav_encoding" class="navsublink" href="encoding.xhtml#encoding">How to Change the Charset Encoding of the XML Output</a><a id="nav_consumer" class="navsublink" href="consumer.xhtml#consumer">How to Send the Content Tree to a DOM/SAX Consumer</a><a id="nav_domtree" class="navsublink" href="domtree.xhtml#domtree">How to Read from a DOM Tree</a><a id="nav_stringreading" class="navsublink" href="stringreading.xhtml#stringreading">How to Read from a String</a><a id="nav_stringwriting" class="navsublink" href="stringwriting.xhtml#stringwriting">How to Serialize XML Into a String</a><a id="nav_xpath" class="navsublink" href="xpath.xhtml#xpath">How to Use XPath on JAXB Content Trees</a><a id="nav_xslt" class="navsublink" href="xslt.xhtml#xslt">How to Use JAXB with XSLT</a><a id="nav_performance" class="navsublink" href="performance.xhtml#performance">How to Improve Performance</a><a id="nav_multithreading" class="navsublink" href="multithreading.xhtml#multithreading">How to Write Thread-safe Code with JAXB</a></div></div><div id="popups"><div id="pp-d2e3413" class="tooltip">The <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBContext.html" class="javadoc">JAXBContext</a> represents the mapping between Java classes and XML. You can either specify one or more root classes (it supports varargs) or the name of the package containing the mapping classes. <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/JAXBContext.html" class="javadoc">JAXBContext</a> is multi-thread safe and can be shared among threads (note that you can not share <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Marshaller.html" class="javadoc">Marshaller</a> and <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/Unmarshaller.html" class="javadoc">Unmarshaller</a>).</div><div id="pp-d2e3453" class="tooltip"><span class="idf">xjc</span> does not set it if the root element is defined using a stand-alone complex type instead of an inline type. Then <span class="idf">xjc</span> can not be sure whether all uses of the complex type are really as root type, and thus it can not write the <a href="http://java.sun.com/javase/6/docs/api/javax/xml/bind/annotation/XmlRootElement.html" class="javadoc">@XmlRootElement</a> annotation.</div><div id="ttCloseBar" class="closeBar"><a href="#" onclick="return tlClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="topicCloseBar" class="closeBar"><a href="#" onclick="return tpcClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div></div></body></html>