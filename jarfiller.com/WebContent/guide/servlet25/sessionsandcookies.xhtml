<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.w3.org/1999/xhtml" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:page="http://tjansen.de/refPage" xmlns:i="http://tjansen.de/internal"><head><title>Sessions and Cookies - Servlet 2.5 Guide</title><meta http-equiv="X-UA-Compatible" content="chrome=1"/><meta http-equiv="content-language" content="en"/><link rel="shortcut icon" href="../../images/favicon.png" type="image/png"/><link rel="stylesheet" type="text/css" href="../../style/style.css"/><script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-6791190-2']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
})();
</script><script type="text/javascript" src="../../js/all.js"/></head><body id="body"><div id="visibleContent"><div id="top"><a href="/"><img src="../../images/titlebar.png" alt="Jarfiller.com"/></a></div><div id="main"><div id="bodycolumn"><div class="yahbar"><div class="yahprev"><a href="requests.xhtml">Prev</a></div><h3 class="yahhere"><a href="#" onclick="return navToggle();">Servlet 2.5 Guide / Sessions and Cookies</a></h3><div class="yahnext"><a href="resources.xhtml">Next</a></div></div><h1 id="sec_sessionsandcookies" class="multipageTitle"><a name="sessionsandcookies">Sessions and Cookies</a></h1><div class="subSecRow2" id="sec_cookies"><div class="subSecHead" id="sechd_cookies"><a name="cookies">Cookies</a><br/>(<a href="#" id="tl-d22757e5041" class="dottedTooltip" onclick="return tlClick('tl-d22757e5041','pp-d22757e5046');" onmouseover="return tlOver('tl-d22757e5041','pp-d22757e5046');" onmouseout="return tlOut('tl-d22757e5041','pp-d22757e5046');">more</a>)
		</div><div class="subSecContent" id="seccnt_cookies"><pre class="subSecCode"><code>final static String COOKIE_NAME = "visitCounter";

<span class="cmt">// This method uses <a href="#" id="tl-d22757e5068" class="dottedTooltip" onclick="return tlClick('tl-d22757e5068','pp-d22757e5071');" onmouseover="return tlOver('tl-d22757e5068','pp-d22757e5071');" onmouseout="return tlOut('tl-d22757e5068','pp-d22757e5071');">cookies</a> to find out how many times the user</span>
<span class="cmt">// has visited the servlet before:</span>
protected void <a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServlet.html#doGet(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)" class="javadoc">doGet</a>(<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletRequest.html" class="javadoc">HttpServletRequest</a> request, <a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletResponse.html" class="javadoc">HttpServletResponse</a> response)
      throws <a href="http://java.sun.com/javase/6/docs/api/java/io/IOException.html" class="javadoc">IOException</a> {

    response.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletResponse.html#setContentType(java.lang.String)" class="javadoc">setContentType</a>("text/plain; charset=UTF-8");     <span class="cmt">// plain text (<a href="#" id="tl-d22757e5112" class="dottedTooltip" onclick="return tlClick('tl-d22757e5112','pp-d22757e4581');" onmouseover="return tlOver('tl-d22757e5112','pp-d22757e4581');" onmouseout="return tlOut('tl-d22757e5112','pp-d22757e4581');">more</a>)</span>
    response.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletResponse.html#setCharacterEncoding(java.lang.String)" class="javadoc">setCharacterEncoding</a>("UTF-8");
    <a href="http://java.sun.com/javase/6/docs/api/java/io/PrintWriter.html" class="javadoc">PrintWriter</a> writer = response.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletResponse.html#getWriter()" class="javadoc">getWriter</a>();

    <span class="cmt">// Finding the cookie (if it exists)</span>
    int visits = 0;
    if (request.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/getCookies().html" class="javadoc">getCookies()</a> != null)                         <span class="cmt">// may be null if no cookies (<a href="#" id="tl-d22757e5147" class="dottedTooltip" onclick="return tlClick('tl-d22757e5147','pp-d22757e5147');" onmouseover="return tlOver('tl-d22757e5147','pp-d22757e5147');" onmouseout="return tlOut('tl-d22757e5147','pp-d22757e5147');">more</a>)</span>
        for (<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/Cookie.html" class="javadoc">Cookie</a> c: request.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletRequest.html#getContextPath()" class="javadoc"><em>getCookies</em></a>())
            if (c.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/Cookie.html#getName()" class="javadoc">getName</a>().equals(COOKIE_NAME) &amp;&amp; c.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/Cookie.html#getValue()" class="javadoc">getValue</a>().<a href="http://java.sun.com/javase/6/docs/api/java/lang/String.html#matches(java.lang.String)" class="javadoc">matches</a>("[0-9]+"))
                visits = Integer.parseInt(c.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/Cookie.html#getValue()" class="javadoc">getValue</a>());

    <span class="cmt">// Print a message for the user</span>
    if (visits == 0)
        writer.<a href="http://java.sun.com/javase/6/docs/api/java/io/PrintWriter.html#println(java.lang.String)" class="javadoc">println</a>("This is your first visit.");
    else
        writer.<a href="http://java.sun.com/javase/6/docs/api/java/io/PrintWriter.html#printf(java.lang.String, java.lang.Object...)" class="javadoc">printf</a>("This is visit number %d.\n", visits);  <span class="cmt">// formatted printing (<a href="#" id="tl-d22757e5208" class="dottedTooltip" onclick="return tlClick('tl-d22757e5208','pp-d22757e4652');" onmouseover="return tlOver('tl-d22757e5208','pp-d22757e4652');" onmouseout="return tlOut('tl-d22757e5208','pp-d22757e4652');">more</a>)</span>

    <span class="cmt">// Set / Update the cookie (<a href="#" id="tl-d22757e5217" class="dottedTooltip" onclick="return tlClick('tl-d22757e5217','pp-d22757e5217');" onmouseover="return tlOver('tl-d22757e5217','pp-d22757e5217');" onmouseout="return tlOut('tl-d22757e5217','pp-d22757e5217');">more</a>)</span>
    <a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/Cookie.html" class="javadoc">Cookie</a> c = <em>new <a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/Cookie.html" class="javadoc">Cookie</a></em>(COOKIE_NAME, Integer.toString(visits + 1));
    c.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/Cookie.html#setMaxAge(int)" class="javadoc"><em>setMaxAge</em></a>(60*60*24*28);                                 <span class="cmt">// valid for 28 days (<a href="#" id="tl-d22757e5261" class="dottedTooltip" onclick="return tlClick('tl-d22757e5261','pp-d22757e5261');" onmouseover="return tlOver('tl-d22757e5261','pp-d22757e5261');" onmouseout="return tlOut('tl-d22757e5261','pp-d22757e5261');">more</a>)</span>
    response.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletResponse.html#addCookie(javax.servlet.http.Cookie)" class="javadoc"><em>addCookie</em></a>(c);
}
</code></pre></div></div><div class="subSecRow1" id="sec_sessions"><div class="subSecHead" id="sechd_sessions"><a name="sessions">Sessions</a></div><div class="subSecContent" id="seccnt_sessions"><p class="subSecExplanation"><a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSession.html" class="javadoc">HttpSession</a> allows you to <em>store arbitrary objects</em> for a user as named <em>attributes</em>. Sessions are <em>managed by the web container</em>, which <em>associates a session id with every session</em> and uses mechanisms such as cookies to <em>store the session id in the client</em> (<a href="#" id="tl-d22757e5315" class="dottedTooltip" onclick="return tlClick('tl-d22757e5315','pp-d22757e5315');" onmouseover="return tlOver('tl-d22757e5315','pp-d22757e5315');" onmouseout="return tlOut('tl-d22757e5315','pp-d22757e5315');">more</a>).<br/> Sessions are typically <em>short lived</em>, and do not survive neither a browser-restart nor a server-restart (<a href="#" id="tl-d22757e5337" class="dottedTooltip" onclick="return tlClick('tl-d22757e5337','pp-d22757e5337');" onmouseover="return tlOver('tl-d22757e5337','pp-d22757e5337');" onmouseout="return tlOut('tl-d22757e5337','pp-d22757e5337');">more</a>).</p><p class="subSecExplanation">The following example implements a visitor counter with HttpSessions:</p><pre class="subSecCode"><code>final static String ATTRIBUTE_NAME = "visitCounter";

protected void <a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServlet.html#doGet(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)" class="javadoc">doGet</a>(<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletRequest.html" class="javadoc">HttpServletRequest</a> request, <a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletResponse.html" class="javadoc">HttpServletResponse</a> response)
      throws <a href="http://java.sun.com/javase/6/docs/api/java/io/IOException.html" class="javadoc">IOException</a> {

    response.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletResponse.html#setContentType(java.lang.String)" class="javadoc">setContentType</a>("text/plain; charset=UTF-8");     <span class="cmt">// plain text (<a href="#" id="tl-d22757e5389" class="dottedTooltip" onclick="return tlClick('tl-d22757e5389','pp-d22757e4581');" onmouseover="return tlOver('tl-d22757e5389','pp-d22757e4581');" onmouseout="return tlOut('tl-d22757e5389','pp-d22757e4581');">more</a>)</span>
    response.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletResponse.html#setCharacterEncoding(java.lang.String)" class="javadoc">setCharacterEncoding</a>("UTF-8");
    <a href="http://java.sun.com/javase/6/docs/api/java/io/PrintWriter.html" class="javadoc">PrintWriter</a> writer = response.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletResponse.html#getWriter()" class="javadoc">getWriter</a>();

    <span class="cmt">// Reading the session</span>
    int visits = 0;
    <a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSession.html" class="javadoc">HttpSession</a> session = request.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletRequest.html#getSession()" class="javadoc">getSession</a>();               <span class="cmt">// can create session (<a href="#" id="tl-d22757e5427" class="dottedTooltip" onclick="return tlClick('tl-d22757e5427','pp-d22757e5427');" onmouseover="return tlOver('tl-d22757e5427','pp-d22757e5427');" onmouseout="return tlOut('tl-d22757e5427','pp-d22757e5427');">more</a>)</span>
    if (session.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSession.html#getAttribute(java.lang.String)" class="javadoc">getAttribute</a>(ATTRIBUTE_NAME) != null)         <span class="cmt">// not set in new sessions</span>
        if (c.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/Cookie.html#getName()" class="javadoc">getName</a>().equals(COOKIE_NAME) &amp;&amp; c.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/Cookie.html#getValue()" class="javadoc">getValue</a>().<a href="http://java.sun.com/javase/6/docs/api/java/lang/String.html#matches(java.lang.String)" class="javadoc">matches</a>("[0-9]+"))
            visits = (Integer) session.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSession.html#getAttribute(java.lang.String)" class="javadoc">getAttribute</a>(ATTRIBUTE_NAME);

    <span class="cmt">// Print a message for the user</span>
    if (visits == 0)
        writer.<a href="http://java.sun.com/javase/6/docs/api/java/io/PrintWriter.html#println(java.lang.String)" class="javadoc">println</a>("This is your first visit.");
    else
        writer.<a href="http://java.sun.com/javase/6/docs/api/java/io/PrintWriter.html#printf(java.lang.String, java.lang.Object...)" class="javadoc">printf</a>("This is visit number %d.\n", visits);  <span class="cmt">// formatted printing (<a href="#" id="tl-d22757e5485" class="dottedTooltip" onclick="return tlClick('tl-d22757e5485','pp-d22757e4652');" onmouseover="return tlOver('tl-d22757e5485','pp-d22757e4652');" onmouseout="return tlOut('tl-d22757e5485','pp-d22757e4652');">more</a>)</span>

    <span class="cmt">// Update the session</span>
    session.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSession.html#setAttribute(java.lang.String, java.lang.Object)" class="javadoc">setAttribute</a>(ATTRIBUTE_NAME, visits + 1);
    session.<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSession.html#setMaxInactiveInterval(int)" class="javadoc">setMaxInactiveInterval</a>(60*60*24);                 <span class="cmt">// valid for 24 hours max</span>
}
</code></pre></div></div><div class="subSecRow2" id="sec_distributablesessions"><div class="subSecHead" id="sechd_distributablesessions"><a name="distributablesessions">Distributable Sessions</a></div><div class="subSecContent" id="seccnt_distributablesessions"><h2 class="subSecSummaryNoClick">Sessions in Distributed Servers (Clusters)</h2><p class="subSecExplanation">When you configure your web application to be <em>distributable</em> (thus you have not a single container, but a cluster of containers hosting your application), you must be sure that you <em>store only serializable objects</em> in the session (some containers also support EJB references). Distributable containers can move sessions across servers, and serialization allows the container to do this. Objects stored in a session can implement the <a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSessionActivationListener.html" class="javadoc">HttpSessionActivationListener</a> interface to be notified before and after such a migration.</p><p class="subSecExplanation">See also <a href="distributedapps.xhtml#distributedapps">How to Write Distributed Applications</a> below.</p></div></div><div class="subSecRow1" id="sec_sessioncaveat"><div class="subSecHead" id="sechd_sessioncaveat"><a name="sessioncaveat">Session Caveat</a></div><div class="subSecContent" id="seccnt_sessioncaveat"><h2 class="subSecSummaryNoClick">Be Careful When Using HttpSession</h2><p class="subSecExplanation"> <a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSession.html" class="javadoc">HttpSession</a> looks simple and easy to use. In practice, however, you should <em>consider carefully what you store in a session</em>. There are three pitfalls:</p><ol class="subSecList"><li>Attribute values put into the session will be <em>accessed by several threads simultanously</em>, so proper synchronization and/or thread-safe objects are required.</li><li>In general, you should <em>store only the user's identity and configuration</em> in the session. Using it for most other purposes, for example storing the state of a multi-page form in the session, is a very bad idea (<a href="#" id="tl-d22757e5578" class="dottedTooltip" onclick="return tlClick('tl-d22757e5578','pp-d22757e5578');" onmouseover="return tlOver('tl-d22757e5578','pp-d22757e5578');" onmouseout="return tlOut('tl-d22757e5578','pp-d22757e5578');">more</a>).</li><li>When working with sessions, <em>be careful about memory use</em>. If you store large objects in your session and have many visitors, you may run out of heap memory. Be aware that <em>people with disabled cookies create a new session with every hit</em>, because they always look like a new visitor to the server.</li></ol><p class="subSecExplanation">Often <em>using cookies is easier than using sessions</em>. You may need to write a few more lines to use them, but they are easier to debug and implement correctly. </p></div></div><div class="yahbar"><div class="yahprev"><a href="requests.xhtml">Prev<br/><span>Requests</span></a></div><div class="yahhere"><a href="#" onclick="return navToggle();">Servlet 2.5 Guide / Sessions and Cookies</a><br/><a href="/guide/servlet25/"><span>Single Page Mode</span></a>, <a href="#" onclick="return navToggle();"><span>Show Table of Content</span></a></div><div class="yahnext"><a href="resources.xhtml">Next<br/><span>Resources</span></a></div></div></div><div id="sidecolumn">
    	<div><h3>Useful Links</h3><div class="sidecolumnSubTitleLine"/>
	  			<a href="http://java.sun.com/products/servlet/">Servlet Homepage</a><br/>
	  			<a href="http://en.wikipedia.org/wiki/Java_Servlet">Servlet on Wikipedia</a><br/>
	  			<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/package-summary.html">javax.servlet API Docs</a><br/>
	  			<a href="http://java.sun.com/javaee/5/docs/api/javax/servlet/package-summary.html">javax.servlet.http API Docs</a><br/>
	  			<a href="http://jcp.org/aboutJava/communityprocess/mrel/jsr154/index2.html">Servlet 2.5 Specification</a><br/>
	  		</div>
  		
  		<div><h3>Related Documents</h3><div class="sidecolumnSubTitleLine">(on Jarfiller.com)</div>
	  			<a href="/reference/webxml2x/">Web.xml Reference</a><br/>
	  		</div>
  	
  </div></div></div><div id="footer"><div id="footer-content"><div id="footer-left"><div class="footerLine"><a href="/">Home</a> - <a href="/about">About Jarfiller</a> - <a href="/imprint.xhtml">Imprint</a></div><div class="footerLine">Please send feedback and corrections to <a href="mailto:tim@tjansen.de">tim@<span style="display: none">got you</span>tjansen.de</a>.</div><div class="footerLine"><a href="http://www.twitter.com/timjansen">Follow</a> me on Twitter.</div><div class="copyrightLine">Â© 2010 Tim Jansen; content licensed under <a href="http://creativecommons.org/licenses/by/3.0/us/">cc-by</a>; example source code is public domain
				</div></div><div id="footer-right"><a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="../../images/ext/cc-by-88x31.png"/></a></div></div></div><div id="navbar" onclick="return navToggle();" onmouseover="document.getElementById('navbar').className='mouseover';" onmouseout="document.getElementById('navbar').className='';"/><div id="navcontainer"><div id="navlinks"><div id="navclosebar"><a href="#" onclick="return navClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="navpositionbar" class="navpositionbar"/><h2 id="navtitle">Servlet 2.5 Guide</h2><a id="nav_overview" class="navseclink" href="overview.xhtml#overview">Overview</a><a id="nav_intro" class="navsublink" href="overview.xhtml#intro">Intro</a><a id="nav_usecases" class="navsublink" href="overview.xhtml#usecases">When should you write a Servlet?</a><a id="nav_requirements" class="navsublink" href="overview.xhtml#requirements">What do you need for Servlets?</a><a id="nav_containers" class="navsublink" href="overview.xhtml#containers">Which container supports which Servlet / JEE version?</a><a id="nav_httpintro" class="navsublink" href="overview.xhtml#httpintro">Short HTTP Introduction</a><a id="nav_servlets" class="navseclink" href="servlets.xhtml#servlets">Servlets</a><a id="nav_servletintro" class="navsublink" href="servlets.xhtml#servletintro">Servlet Intro</a><a id="nav_classoverview" class="navsublink" href="servlets.xhtml#classoverview">Class Overview</a><a id="nav_servletclass" class="navsublink" href="servlets.xhtml#servletclass">Servlet Class</a><a id="nav_servicemethods" class="navsublink" href="servlets.xhtml#servicemethods">Service Dispatching in the HttpServlet</a><a id="nav_lifecycle" class="navsublink" href="servlets.xhtml#lifecycle">The Servlet Lifecycle</a><a id="nav_multithreading" class="navsublink" href="servlets.xhtml#multithreading">Multithreading</a><a id="nav_twothreadsafeways" class="navsublink" href="servlets.xhtml#twothreadsafeways">Two Simple Ways to Write Thread-Safe Servlets</a><a id="nav_webapplications" class="navsublink" href="servlets.xhtml#webapplications">Web Applications</a><a id="nav_webxml" class="navsublink" href="servlets.xhtml#webxml">web.xml</a><a id="nav_applayout" class="navsublink" href="servlets.xhtml#applayout">Example Application Layout</a><a id="nav_contextroot" class="navsublink" href="servlets.xhtml#contextroot">Context Root</a><a id="nav_staticcontent" class="navsublink" href="servlets.xhtml#staticcontent">Static Content</a><a id="nav_eclipse" class="navsublink" href="servlets.xhtml#eclipse">How to Create a Web Application with Eclipse</a><a id="nav_ant" class="navsublink" href="servlets.xhtml#ant">How to Create a Web Application (WAR) with Ant</a><a id="nav_tomcat" class="navsublink" href="servlets.xhtml#tomcat">How to Deploy a Web Application on Tomcat</a><a id="nav_responses" class="navseclink" href="responses.xhtml#responses">Responses</a><a id="nav_textoutput" class="navsublink" href="responses.xhtml#textoutput">Text Output</a><a id="nav_responsebinary" class="navsublink" href="responses.xhtml#responsebinary">Binary Output</a><a id="nav_buffering" class="navsublink" href="responses.xhtml#buffering">Buffering and Committing</a><a id="nav_errors" class="navsublink" href="responses.xhtml#errors">Error Code</a><a id="nav_redirection" class="navsublink" href="responses.xhtml#redirection">Redirection</a><a id="nav_requests" class="navseclink" href="requests.xhtml#requests">Requests</a><a id="nav_reqparameters" class="navsublink" href="requests.xhtml#reqparameters">Request Parameters</a><a id="nav_parameternames" class="navsublink" href="requests.xhtml#parameternames">How to find out which parameters have been sent</a><a id="nav_headers" class="navsublink" href="requests.xhtml#headers">How to read header values</a><a id="nav_paths" class="navsublink" href="requests.xhtml#paths">Paths</a><a id="nav_sessionsandcookies" class="navseclink" href="#sessionsandcookies" onclick="if (event.button == 0) return goTo('#sessionsandcookies', true); else return true;">Sessions and Cookies</a><a id="nav_cookies" class="navsublink" href="#cookies" onclick="if (event.button == 0) return goTo('#cookies', true); else return true;">Cookies</a><a id="nav_sessions" class="navsublink" href="#sessions" onclick="if (event.button == 0) return goTo('#sessions', true); else return true;">Sessions</a><a id="nav_distributablesessions" class="navsublink" href="#distributablesessions" onclick="if (event.button == 0) return goTo('#distributablesessions', true); else return true;">Sessions in Distributed Servers (Clusters)</a><a id="nav_sessioncaveat" class="navsublink" href="#sessioncaveat" onclick="if (event.button == 0) return goTo('#sessioncaveat', true); else return true;">Be Careful When Using HttpSession</a><a id="nav_resources" class="navseclink" href="resources.xhtml#resources">Resources</a><a id="nav_resourceannotations" class="navsublink" href="resources.xhtml#resourceannotations">Resource Annotations</a><a id="nav_jndilookup" class="navsublink" href="resources.xhtml#jndilookup">How to get resources with JNDI</a><a id="nav_tomcatresources" class="navsublink" href="resources.xhtml#tomcatresources">How to Provide Resources in Tomcat</a><span class="navseclink">How to... Requests and Responses</span><a id="nav_customheaders" class="navsublink" href="customheaders.xhtml#customheaders">How to Read and Write Additional Headers</a><a id="nav_attributes" class="navsublink" href="attributes.xhtml#attributes">How to Use Attributes in Request and Context</a><a id="nav_getlastmodified" class="navsublink" href="getlastmodified.xhtml#getlastmodified">How to Use HttpServlet.getLastModified to Improve Client-Side Caching</a><a id="nav_contentlength" class="navsublink" href="contentlength.xhtml#contentlength">How to Set the Content Length</a><a id="nav_fileupload" class="navsublink" href="fileupload.xhtml#fileupload">How to Receive File Uploads (Multi-Part File Upload)</a><a id="nav_browserdetection" class="navsublink" href="browserdetection.xhtml#browserdetection">How to Detect the User's Web Browser</a><a id="nav_contentlanguage" class="navsublink" href="contentlanguage.xhtml#contentlanguage">How to Declare the Content Language</a><a id="nav_acceptedlanguages" class="navsublink" href="acceptedlanguages.xhtml#acceptedlanguages">How to Detect the Client's Preferred Languages</a><a id="nav_sendingxml" class="navsublink" href="sendingxml.xhtml#sendingxml">How to Send XML as Response</a><a id="nav_dynamicimages" class="navsublink" href="dynamicimages.xhtml#dynamicimages">How to Generate Images as Response</a><a id="nav_jspforward" class="navsublink" href="jspforward.xhtml#jspforward">How to Use a JSP as Template</a><a id="nav_requestdispatcher" class="navsublink" href="requestdispatcher.xhtml#requestdispatcher">How to Invoke Servlets and JSPs with the RequestDispatcher</a><a id="nav_virtualhosts" class="navsublink" href="virtualhosts.xhtml#virtualhosts">How to Handle Virtual Hosts and Multiple IP Addresses?</a><a id="nav_filters" class="navsublink" href="filters.xhtml#filters">How to Write Filters</a><span class="navseclink">How to... Sessions and Security</span><a id="nav_usermanagement" class="navsublink" href="usermanagement.xhtml#usermanagement">How to Authenticate and Manage Users</a><a id="nav_declarativesecurity" class="navsublink" href="declarativesecurity.xhtml#declarativesecurity">How to Restrict Access to a Web Application (Declarative Security)</a><a id="nav_requiringssl" class="navsublink" href="requiringssl.xhtml#requiringssl">How to Require HTTPS / SSL</a><a id="nav_programmaticsecurity" class="navsublink" href="programmaticsecurity.xhtml#programmaticsecurity">How to Use Authentication Data in Servlets</a><a id="nav_cookielessessions" class="navsublink" href="cookielessessions.xhtml#cookielessessions">How to Use HttpSessions and Authentication without Cookies?</a><span class="navseclink">How to... General</span><a id="nav_addinglibraries" class="navsublink" href="addinglibraries.xhtml#addinglibraries">How to Add Libraries to a Web Application / WAR</a><a id="nav_addingresourcefiles" class="navsublink" href="addingresourcefiles.xhtml#addingresourcefiles">How to Read Files Contained in a Web Application / WAR</a><a id="nav_throwingexceptions" class="navsublink" href="throwingexceptions.xhtml#throwingexceptions">How to Throw Exceptions in Servlets</a><a id="nav_initparameters" class="navsublink" href="initparameters.xhtml#initparameters">Configure your Servlet with Initialization Parameters</a><a id="nav_logging" class="navsublink" href="logging.xhtml#logging">How to Log</a><a id="nav_errorpages" class="navsublink" href="errorpages.xhtml#errorpages">How to Replace the Default Error Page</a><a id="nav_temporarydirectory" class="navsublink" href="temporarydirectory.xhtml#temporarydirectory">How to Get a Temporary Directory</a><a id="nav_ejbinvocation" class="navsublink" href="ejbinvocation.xhtml#ejbinvocation">How to Access an EJB</a><a id="nav_distributedapps" class="navsublink" href="distributedapps.xhtml#distributedapps">How to Create a Distributed Application</a><a id="nav_listeners" class="navsublink" href="listeners.xhtml#listeners">How to Be Notified about Events (Listeners)</a><a id="nav_servlet24" class="navsublink" href="servlet24.xhtml#servlet24">New Features Since Servlet API 2.4</a><a id="nav_andnow" class="navseclink" href="andnow.xhtml#andnow">And now...?</a><a id="nav_nextsteps" class="navsublink" href="andnow.xhtml#nextsteps">Next Steps</a></div></div><div id="popups"><div id="pp-d22757e5046" class="tooltip">The Servlet API represents cookies with the <span class="idf">Cookie</span> object. Use <span class="idf">getCookies</span> on the request to get a list of all cookies sent by the client. In order to add or update a cookie, use the response's <span class="idf">addCookie</span> method.</div><div id="pp-d22757e5147" class="tooltip">Unfortunately, if there is is no cookie sent by the browser, <span class="idf">getCookies</span> returns null instead of an empty array. So you always need to check for null first.</div><div id="pp-d22757e5217" class="tooltip">To modify a cookie, <em>create a new <span class="idf">Cookie</span></em> instance and set it with <span class="idf">addCookie</span>.<br/> Only modifying a <span class="idf">Cookie</span> returned by <span class="idf">getCookies</span> will not work, you <em>always need to call <span class="idf">addCookie</span></em> to update a cookie, even if the cookie already exists!</div><div id="pp-d22757e5261" class="tooltip">By default, a cookie is only <em>valid for the current session</em>. That means that the browser will forget about the cookie as soon as it is closed. In order to let the browser save the cookie, you need to <em>give it an expiration date</em> as shown here. <br/> The value passed to <span class="idf">setMaxAge</span> is the cookie's <em>maximum age in seconds</em>.</div><div id="pp-d22757e5315" class="tooltip">Storing the session id in a cookie is the most important way for the container to connect sessions to browsers, but there are others: if the connection is SSL-encrypted (HTTPS), <em>SSL's session mechanism</em> will be used. As a third option, the container may <em>rewrite URLs</em> and add the session id to them. The latter approach works with every browset, but you have to modify every single link on your pages using the <span class="idf">encodeURL</span> string rewriting method.<br/> Note that the session implementation's <em>details are container-specific</em>.</div><div id="pp-d22757e5337" class="tooltip">Web containers <em>use session-only cookies to store the session id</em>. Thus the session is lost when the browser is restarted, and the server will create a new one.<br/> By default, containers <em>do not persist the http sessions</em>, and thus all sessions are lost on restart. Some containers offer you container-specific way to store sessions though, for clustering (several servers sharing the same session objects) or to allow restarts without losing sessions. <br/> If you need to store data about the user for a longer time, you should use cookies. </div><div id="pp-d22757e5427" class="tooltip"><span class="idf">getSession</span> returns the user's session if there is already one. Otherwise it creates a new session.</div><div id="pp-d22757e5578" class="tooltip">The problem is that users will not go through pages linearly. They may use the browser's back button to revisit a page, or open a new tab and go through the multi-page form with several tabs at the same time. Another common pitfall is that many people double-click links and thus may submit the content twice. <br/> If you write a multi-page-form, you should store all data as hidden fields in the form. Everything else is a nightmare to debug.</div><div id="pp-d22757e5071" class="tooltip">Cookies are name/value string pairs that a server can store in the browser to store things such as the user's identity and configuration. In the browser's request it sends all cookies that it has for the server name. In the server's response, the server can add or overwrite cookies by sending a special header.<br/> To learn more about cookies, read <a href="http://en.wikipedia.org/wiki/HTTP_cookie">HTTP Cookie</a> on Wikipedia.</div><div id="ttCloseBar" class="closeBar"><a href="#" onclick="return tlClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div><div id="topicCloseBar" class="closeBar"><a href="#" onclick="return tpcClose();"><img src="../../images/close.png" height="16" width="16" alt="close"/></a></div></div></body></html>